
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>22.3. AES &#8212; Math Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css?v=564be945" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'cryptography/AES';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="22.4. Kuznyechik" href="kuznyechik.html" />
    <link rel="prev" title="22.2. SMS4" href="sms4.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/Euler_Stamp.jpg" class="logo__image only-light" alt="Math Book - Home"/>
    <script>document.write(`<img src="../_static/Euler_Stamp.jpg" class="logo__image only-dark" alt="Math Book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Toán học và những niềm đau
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Đại số</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../algebra/algebra.html">1. Đại cương về tập hợp</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../algebra/polynomial.html">2. Đa thức</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../algebra/lagrange-interpolation.html">2.1. Đa thức nội suy Lagrange</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../algebra/infinity.html">3. Sự vô hạn</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Đại số tuyến tính</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../linalg/intro.html">4. Ma trận</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Giải tích</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../calculus/calculus.html">5. Giải tích</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../calculus/partial-derivative.html">5.5. Đạo hàm một số hàm nhiều biến</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../calculus/series.html">6. Chuỗi số</a></li>
<li class="toctree-l1"><a class="reference internal" href="../calculus/differential-equation.html">7. Phương trình vi phân</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Xác suất</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../probability/intro.html">8. Xác suất thống kê</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Toán rời rạc</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../discrete-mathematics/group.html">9. Lý thuyết nhóm</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../discrete-mathematics/group-intro.html">9.1. Nhóm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discrete-mathematics/symmetric-group.html">9.2. Nhóm hoán vị</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discrete-mathematics/group-homomorphism.html">9.3. Group homomorphism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discrete-mathematics/ring-and-field.html">9.4. Vành và trường</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discrete-mathematics/group-action.html">9.5. Tác động nhóm</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../discrete-mathematics/galois-theory.html">10. Lý thuyết Galois</a></li>
<li class="toctree-l1"><a class="reference internal" href="../discrete-mathematics/number-theory.html">11. Số học</a></li>
<li class="toctree-l1"><a class="reference internal" href="../discrete-mathematics/binary-relation.html">12. Quan hệ hai ngôi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../discrete-mathematics/partition.html">13. Phân hoạch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../discrete-mathematics/combinatoric.html">14. Đại cương tổ hợp</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../discrete-mathematics/boolean.html">15. Đại số boolean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../discrete-mathematics/boolean-function.html">15.1. Hàm boolean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discrete-mathematics/walsh-hadamard-spectre.html">15.2. Trọng số, phổ Furier, phổ Walsh, Hamming distance</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Hình học</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../geometry/analytic-geometry.html">16. Hình học giải tích (theo góc nhìn không giải tích)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geometry/transformation.html">17. Phép biến hình</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geometry/conics.html">18. Ba đường Conic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../brachistochrone/brachistochrone.html">19. Đường đoản thời</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Mật mã học (và những niềm đau)</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro.html">20. Đại số boolean và mật mã học</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="stream-cipher.html">21. Stream cipher</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="linear-feedback-shift-register.html">21.1. Linear Feedback Shift Register</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="block-cipher.html">22. Block cipher</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="magma.html">22.1. Magma</a></li>
<li class="toctree-l2"><a class="reference internal" href="sms4.html">22.2. SMS4</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">22.3. AES</a></li>
<li class="toctree-l2"><a class="reference internal" href="kuznyechik.html">22.4. Kuznyechik</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="differential-attack/differential-attack.html">23. Phá mã vi sai</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="differential-attack/tinydes.html">23.1. Phá mã vi sai trên TinyDES</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="quantum-computing.html">24. Quantum computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="lattice-based.html">25. Lattice-based cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="code-based.html">26. Code-based cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="elliptic.html">27. Đường cong elliptic</a></li>
<li class="toctree-l1"><a class="reference internal" href="discrete-logarithm.html">28. Discrete logarithm</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Теоретико-числовые алгоритмы в криптографии</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../vasilenko/intro.html">29. Теоретико-числовые алгоритмы в криптографии</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../vasilenko/discrete-fourier-transform.html">29.1. Biến đổi Fourier rời rạc</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Olympiad</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../contests/2023/2023.html">2023</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../contests/2023/internet-olympiad/2023.html">Internet Olympiad 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contests/2023/siberian-maths-contest-2023.html">Siberian Mathematical Contest 2023</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contests/2024/2024.html">2024</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../contests/2024/internet-olympiad-2024.html">Internet Olympiad 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contests/2024/cryptofox-2024.html">CryptoFox 2024</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bài tập và lời giải</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../solutions/Judson.html">Abstract Algebra: Theory and Applications</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CTF</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../ctf/2020/2020.html">CTF 2020</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2020/midnightsunCTF-2020.html">Midnight Sun CTF 2020</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ctf/2021/2021.html">CTF 2021</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2021/cryptoCTF-2021.html">Crypto CTF 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2021/googleCTF-2021.html">Google CTF 2021</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ctf/2022/2022.html">CTF 2022</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2022/isitdtu-2022.html">ISITDTU Quals 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2022/downunderCTF-2022.html">DownUnder CTF 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2022/sekaiCTF-2022.html">Sekai CTF 2022</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ctf/2023/2023.html">CTF 2023</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2023/AmateursCTF-2023.html">Amateurs CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2023/diceCTF-2023.html">Dice CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2023/googleCTF-2023.html">Google CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2023/backdoorCTF-2023.html">Backdoor CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2023/utctf-2023.html">UTCTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2023/wolvCTF-2023.html">Wolv CTF 2023</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ctf/2024/2024.html">CTF 2024</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2024/0xL4ughCTF-2024.html">0xL4ugh CTF 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2024/TJCTF/TJCTF-2024-part-1.html">TJCTF 2024 phần 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2024/TJCTF/TJCTF-2024-part-2.html">TJCTF 2024 phần 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ctf/2024/TJCTF/TJCTF-2024-part-3.html">TJCTF 2024 phần 3</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Review sách</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../book-review/intro.html">Review sách</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../book-review/thien-tai-va-so-phan.html">Sách <em>Thiên tài và số phận</em></a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/dunglq2000/mathematics" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/dunglq2000/mathematics/issues/new?title=Issue%20on%20page%20%2Fcryptography/AES.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/cryptography/AES.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>AES</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#substitute-bytes">22.3.1. Substitute Bytes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">22.3.1.1. Substitute Bytes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-sub-bytes">22.3.1.2. Inverse Sub Bytes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#y-nghia-cua-substitute-bytes">22.3.1.3. Ý nghĩa của Substitute Bytes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shift-rows">22.3.2. Shift Rows</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">22.3.2.1. Shift Rows</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-shift-rows">22.3.2.2. Inverse Shift Rows</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#y-nghia">22.3.2.3. Ý nghĩa</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mix-columns">22.3.3. Mix Columns</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">22.3.3.1. Mix Columns</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-mix-columns">22.3.3.2. Inverse Mix Columns</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">22.3.3.3. Ý nghĩa</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-round-key">22.3.4. Add Round Key</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">22.3.4.1. Add Round Key</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">22.3.4.2. Ý nghĩa</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expand-key">22.3.5. Expand Key</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">22.3.5.1. Expand Key</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#y-nghia-cua-expand-key">22.3.5.2. Ý nghĩa của Expand Key</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ket-luan">22.3.6. Kết luận</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ve-phep-mix-columns">22.3.7. Về phép Mix Columns</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="aes">
<h1><span class="section-number">22.3. </span>AES<a class="headerlink" href="#aes" title="Link to this heading">#</a></h1>
<p>AES biến đổi theo khối <span class="math notranslate nohighlight">\(128\)</span> bit, sử dụng mô hình mạng SPN.</p>
<p>Bốn phép biến đổi chính là Add Round Key, Substitute Bytes, Shift Rows và Mix Columns.</p>
<p>Quá trình giải mã sử dụng phép biến đổi ngược của bốn phép biến đổi trên là Inverse Sub Bytes, Inverse Shift Rows, Inverse Mix Columns. Đối với Add Round Key bản thân là phép XOR nên phép biến đổi ngược là chính nó.</p>
<p>AES hỗ trợ key với các kích thước: <span class="math notranslate nohighlight">\(128\)</span> bit, <span class="math notranslate nohighlight">\(192\)</span> bit và <span class="math notranslate nohighlight">\(256\)</span> bit.</p>
<p>Đối với kích thước khóa <span class="math notranslate nohighlight">\(128\)</span> bit, AES dùng hàm Expand Key để mở rộng khóa thành <span class="math notranslate nohighlight">\(44\)</span> word, mỗi word có <span class="math notranslate nohighlight">\(32\)</span> bit, với key <span class="math notranslate nohighlight">\(128\)</span> bit thành <span class="math notranslate nohighlight">\(11\)</span> cụm khóa con. Mỗi <span class="math notranslate nohighlight">\(4\)</span> word làm tham số cho một phép Add Round Key.</p>
<p>Mỗi block bản rõ <span class="math notranslate nohighlight">\(16\)</span> byte <span class="math notranslate nohighlight">\(p_0, p_1, \ldots, p_{15}\)</span> được tổ chức dưới dạng một ma trận <span class="math notranslate nohighlight">\(4 \times 4\)</span> (gọi là <strong>ma trận state</strong>)</p>
<figure class="align-default">
<img alt="../_images/state.jpg" src="../_images/state.jpg" />
</figure>
<ol class="arabic simple">
<li><p>Các phép biến đổi Add Round Key, Substitute Bytes, Shift Rows, Mix Columns được thực hiện trên ma trận <span class="math notranslate nohighlight">\(4 \times 4\)</span> này.</p></li>
<li><p>Các phép tính số học trong AES được thực hiện trong <span class="math notranslate nohighlight">\(\mathrm{GF}(2^8)\)</span> với đa thức tối giản là <span class="math notranslate nohighlight">\(f(x) = x^8 + x^4 + x^3 + x + 1\)</span>.</p></li>
</ol>
<section id="substitute-bytes">
<h2><span class="section-number">22.3.1. </span>Substitute Bytes<a class="headerlink" href="#substitute-bytes" title="Link to this heading">#</a></h2>
<section id="id1">
<h3><span class="section-number">22.3.1.1. </span>Substitute Bytes<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Ta sử dụng một bảng tra cứu <span class="math notranslate nohighlight">\(16 \times 16\)</span> (S-box).</p>
<ol class="arabic simple">
<li><p>Điền các số từ 0 tới 255 theo từng hàng</p></li>
<li><p>Thay thế mối byte trong bảng bằng nghịch đảo trong <span class="math notranslate nohighlight">\(\mathrm{GF}(2^8)\)</span>. Quy ước <span class="math notranslate nohighlight">\((00)^{-1} = 00\)</span></p></li>
<li><p>Với mỗi byte trong bảng, ta ký hiệu 8 bit là <span class="math notranslate nohighlight">\(b_7 b_6 b_5 b_4 b_3 b_2 b_1 b_0\)</span>. Thay thế mỗi <span class="math notranslate nohighlight">\(b_i\)</span> bằng <span class="math notranslate nohighlight">\(b_i'\)</span> như sau</p></li>
</ol>
<div class="math notranslate nohighlight">
\[b'_i = b_i \oplus b_{(i+4) \bmod 8} \oplus b_{(i+5) \bmod 8} \oplus b_{(i+6) \bmod 8} \oplus b_{(i+7) \bmod 8} \oplus c_i\]</div>
<p>với <span class="math notranslate nohighlight">\(c_i\)</span> là bit thứ <span class="math notranslate nohighlight">\(i\)</span> của số <span class="math notranslate nohighlight">\(0x63\)</span>.</p>
<p>Việc tính trên tương đương với phép nhân trên ma trận <span class="math notranslate nohighlight">\(\mathrm{GF}(2)\)</span> là <span class="math notranslate nohighlight">\(B' = XB + C\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
    b'_0 \\ b'_1 \\ b'_2 \\ b'_3 \\ b'_4 \\ b'_5 \\ b'_6 \\ b'_7
\end{bmatrix} = 
\begin{bmatrix}
    1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
    1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 \\
    1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 \\
    1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
    1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1
\end{bmatrix} 
\begin{bmatrix}
    b_0 \\ b_1 \\ b_2 \\ b_3 \\ b_4 \\ b_5 \\ b_6 \\ b_7
\end{bmatrix} + 
\begin{bmatrix}
    1 \\ 1 \\ 0 \\ 0 \\ 0 \\ 1 \\ 1 \\ 0
\end{bmatrix}\end{split}\]</div>
<p>Ma trận <span class="math notranslate nohighlight">\(X\)</span> là ma trận khả nghịch, do đó phép biến đổi S-box là song ánh (one-to-one và onto mapping).</p>
<p>Dựa vào bảng S-box, Substitute Bytes thực hiện như sau: mỗi byte trong ma trận state <span class="math notranslate nohighlight">\(S\)</span> dưới dạng thập lục phân là <span class="math notranslate nohighlight">\(xy\)</span> sẽ được thay bằng giá trị ở hàng <span class="math notranslate nohighlight">\(x\)</span> và cột <span class="math notranslate nohighlight">\(y\)</span> của S-box.</p>
</section>
<section id="inverse-sub-bytes">
<h3><span class="section-number">22.3.1.2. </span>Inverse Sub Bytes<a class="headerlink" href="#inverse-sub-bytes" title="Link to this heading">#</a></h3>
<p>Ta cần xây dựng bảng Inverse Sub Bytes (IS-box).</p>
<p>Việc xây dựng bảng này giống với bảng S-box ở bước 1 và 2. Tại bước 3:</p>
<div class="math notranslate nohighlight">
\[b_i = b'_{(i+2) \bmod 8} \oplus b'_{(i+5) \bmod 8} \oplus b'_{(i+7) \bmod 8} \oplus d_i\]</div>
<p>với <span class="math notranslate nohighlight">\(d_i\)</span> là bit thứ <span class="math notranslate nohighlight">\(i\)</span> của số <span class="math notranslate nohighlight">\(0x05\)</span>.</p>
</section>
<section id="y-nghia-cua-substitute-bytes">
<h3><span class="section-number">22.3.1.3. </span>Ý nghĩa của Substitute Bytes<a class="headerlink" href="#y-nghia-cua-substitute-bytes" title="Link to this heading">#</a></h3>
<p>Bảng S-box dùng để chống lại known-plaintext và là bước duy nhất trong bốn bước không có quan hệ tuyến tính.</p>
</section>
</section>
<section id="shift-rows">
<h2><span class="section-number">22.3.2. </span>Shift Rows<a class="headerlink" href="#shift-rows" title="Link to this heading">#</a></h2>
<section id="id2">
<h3><span class="section-number">22.3.2.1. </span>Shift Rows<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Trong Shift Rows, các dòng của ma trận state được biến đổi như sau:</p>
<ol class="arabic simple">
<li><p>Dòng thứ nhất giữ nguyên</p></li>
<li><p>Dòng 2 dịch vòng trái 1 ô</p></li>
<li><p>Dòng 3 dịch vòng trái 2 ô</p></li>
<li><p>Dòng 4 dịch vòng trái 3 ô</p></li>
</ol>
<figure class="align-default">
<img alt="../_images/shiftrows.jpg" src="../_images/shiftrows.jpg" />
</figure>
</section>
<section id="inverse-shift-rows">
<h3><span class="section-number">22.3.2.2. </span>Inverse Shift Rows<a class="headerlink" href="#inverse-shift-rows" title="Link to this heading">#</a></h3>
<p>Các dòng thứ 2, 3, 4 dịch phải tương ứng 1, 2, 3 ô.</p>
</section>
<section id="y-nghia">
<h3><span class="section-number">22.3.2.3. </span>Ý nghĩa<a class="headerlink" href="#y-nghia" title="Link to this heading">#</a></h3>
<p>Xáo trộn các byte để tạo ra các cột cho Mix Columns.</p>
</section>
</section>
<section id="mix-columns">
<h2><span class="section-number">22.3.3. </span>Mix Columns<a class="headerlink" href="#mix-columns" title="Link to this heading">#</a></h2>
<section id="id3">
<h3><span class="section-number">22.3.3.1. </span>Mix Columns<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>Mix cols biến đổi từng cột của ma trận state một cách độc lập bằng phép nhân đa thức. Giả sử cột đầu tiên của ma trận state viết dưới dạng đa thức là</p>
<div class="math notranslate nohighlight">
\[f(z) = s_{00} z^3 + s_{10} z^2 + s_{20} z + s_{30}\]</div>
<p>với <span class="math notranslate nohighlight">\(z \in \mathrm{GF}(2^8)\)</span></p>
<p>Khi đó <span class="math notranslate nohighlight">\(f(z)\)</span> sẽ được nhân với <span class="math notranslate nohighlight">\(a(z) = 3z^3 + z^2 + z + 2\)</span>, lưu ý rằng tất cả hệ số, phép cộng và nhân thực hiện trên <span class="math notranslate nohighlight">\(\mathrm{GF}(2^8)\)</span>, và sau đó modulo cho <span class="math notranslate nohighlight">\(n(z) = z^4 + 1\)</span>.</p>
<p>Bốn byte hệ số của kết quả sẽ thay thế cho bốn byte tương ứng trong cột. Nếu viết dưới dạng ma trận, ta có</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
    s'_{00} \\ s'_{10} \\ s'_{20} \\ s'_{30}
\end{bmatrix} = \begin{bmatrix}
    02 &amp; 03 &amp; 01 &amp; 01 \\
    01 &amp; 02 &amp; 03 &amp; 01 \\
    01 &amp; 01 &amp; 02 &amp; 03 \\
    03 &amp; 01 &amp; 01 &amp; 02
\end{bmatrix} 
\begin{bmatrix}
    s_{00} \\ s_{10} \\ s_{20} \\ s_{30}
\end{bmatrix}\end{split}\]</div>
<p>Lưu ý rằng các số <span class="math notranslate nohighlight">\(01\)</span>, <span class="math notranslate nohighlight">\(02\)</span>, <span class="math notranslate nohighlight">\(03\)</span> tuy viết dưới dạng thập phân nhưng khi tính toán phải ở dạng <span class="math notranslate nohighlight">\(\mathrm{GF}(2^8)\)</span>. Việc sử dụng <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(2\)</span>, <span class="math notranslate nohighlight">\(3\)</span> giúp tăng tốc độ tính toán vì <span class="math notranslate nohighlight">\(1\)</span> và <span class="math notranslate nohighlight">\(2\)</span> chỉ cần phép dịch bit, còn <span class="math notranslate nohighlight">\(3\)</span> là XOR của <span class="math notranslate nohighlight">\(1\)</span> và <span class="math notranslate nohighlight">\(2\)</span>.</p>
</section>
<section id="inverse-mix-columns">
<h3><span class="section-number">22.3.3.2. </span>Inverse Mix Columns<a class="headerlink" href="#inverse-mix-columns" title="Link to this heading">#</a></h3>
<p>Lúc này ma trận nghịch đảo có dạng</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
    \text{0E} &amp; \text{0B} &amp; \text{0D} &amp; \text{09} \\
    \text{09} &amp; \text{0E} &amp; \text{0B} &amp; \text{0D} \\
    \text{0D} &amp; \text{09} &amp; \text{0E} &amp; \text{0B} \\
    \text{0B} &amp; \text{0D} &amp; \text{09} &amp; \text{0E}
\end{bmatrix}\end{split}\]</div>
</section>
<section id="id4">
<h3><span class="section-number">22.3.3.3. </span>Ý nghĩa<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>Mỗi cột mới chỉ phụ thuộc cột ban đầu. Cùng với sự kết hợp Shift Rows sau một vài vòng biến đổi (cụ thể là <span class="math notranslate nohighlight">\(2\)</span>, các bạn có thể thử chứng minh), <span class="math notranslate nohighlight">\(128\)</span> bit kết quả phụ thuộc vào tất cả <span class="math notranslate nohighlight">\(128\)</span> bit ban đầu. Từ đó tạo ra tính khuếch tán (diffusion).</p>
</section>
</section>
<section id="add-round-key">
<h2><span class="section-number">22.3.4. </span>Add Round Key<a class="headerlink" href="#add-round-key" title="Link to this heading">#</a></h2>
<section id="id5">
<h3><span class="section-number">22.3.4.1. </span>Add Round Key<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(128\)</span> bit của ma trận state được XOR với <span class="math notranslate nohighlight">\(128\)</span> bit của khóa con từng vòng (<span class="math notranslate nohighlight">\(4\)</span> dword <span class="math notranslate nohighlight">\(32\)</span> bit). Phép biến đổi ngược của Add Round Key là chính nó.</p>
</section>
<section id="id6">
<h3><span class="section-number">22.3.4.2. </span>Ý nghĩa<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>Sự kết hợp với khóa tạo ra tính làm rối (confusion).</p>
</section>
</section>
<section id="expand-key">
<h2><span class="section-number">22.3.5. </span>Expand Key<a class="headerlink" href="#expand-key" title="Link to this heading">#</a></h2>
<section id="id7">
<h3><span class="section-number">22.3.5.1. </span>Expand Key<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>Input của thao tác Expand Key là <span class="math notranslate nohighlight">\(16\)</span> byte (<span class="math notranslate nohighlight">\(4\)</span> word) của khóa, sinh ra một mảng <span class="math notranslate nohighlight">\(44\)</span> word (<span class="math notranslate nohighlight">\(176\)</span> byte) sử dụng cho <span class="math notranslate nohighlight">\(11\)</span> vòng AES, mỗi vòng <span class="math notranslate nohighlight">\(4\)</span> word.</p>
<figure class="align-default">
<img alt="../_images/expandkey.jpg" src="../_images/expandkey.jpg" />
</figure>
<p>Từ 4 word đầu vào <span class="math notranslate nohighlight">\(w_0 w_1 w_2 w_3\)</span>, lần lặp đầu sinh ra <span class="math notranslate nohighlight">\(w_4 w_5 w_6 w_7\)</span>, lần lặp thứ hai sinh ra <span class="math notranslate nohighlight">\(w_8 w_9 w_{10} w_{11}\)</span>, \dots</p>
<div class="proof algorithm admonition" id="algorithm-0">
<p class="admonition-title"><span class="caption-number">Algorithm 22.1 </span></p>
<section class="algorithm-content" id="proof-content">
<ol class="arabic simple">
<li><p>if <span class="math notranslate nohighlight">\(i \bmod 4 = 0\)</span></p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(g \gets SubWord(RotWord(w_{i-1})) \oplus Rcon[i/4]\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(w_i = w_{i-4} \oplus g\)</span></p></li>
</ol>
</li>
<li><p>else</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(w_i = w_{i-4} \oplus w_{i-1}\)</span></p></li>
</ol>
</li>
<li><p>endif</p></li>
</ol>
</section>
</div><p>Trong đó,</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(RotWord\)</span> dịch vòng trái <span class="math notranslate nohighlight">\(1\)</span> bit, nghĩa là <span class="math notranslate nohighlight">\(b_0 b_1 b_2 \rightarrow b_1 b_2 b_0\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(SubWord\)</span> thay mỗi byte trong word bằng bảng S-box</p></li>
<li><p><span class="math notranslate nohighlight">\(Rcon\)</span> là một mảng hằng số gồm <span class="math notranslate nohighlight">\(10\)</span> word tương ứng với <span class="math notranslate nohighlight">\(10\)</span> vòng AES. <span class="math notranslate nohighlight">\(4\)</span> byte của một phần tử <span class="math notranslate nohighlight">\(Rcon[j]\)</span> là <span class="math notranslate nohighlight">\(RC[j], 0, 0, 0\)</span> với <span class="math notranslate nohighlight">\(RC[j]\)</span> là mảng <span class="math notranslate nohighlight">\(10\)</span> byte như sau</p></li>
</ol>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(j\)</span></p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
<th class="head"><p>4</p></th>
<th class="head"><p>5</p></th>
<th class="head"><p>6</p></th>
<th class="head"><p>7</p></th>
<th class="head"><p>8</p></th>
<th class="head"><p>9</p></th>
<th class="head"><p>10</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(RC[j]\)</span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>4</p></td>
<td><p>8</p></td>
<td><p>10</p></td>
<td><p>20</p></td>
<td><p>40</p></td>
<td><p>80</p></td>
<td><p>18</p></td>
<td><p>36</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="y-nghia-cua-expand-key">
<h3><span class="section-number">22.3.5.2. </span>Ý nghĩa của Expand Key<a class="headerlink" href="#y-nghia-cua-expand-key" title="Link to this heading">#</a></h3>
<p>Dùng để chống lại known-plaintext (giống Sub Bytes dùng S-box). Đặc điểm của Expand Key gồm:</p>
<ul class="simple">
<li><p>Biết một số bit của khóa hay khóa con không thể tính được các bit còn lại</p></li>
<li><p>KHÔNG THỂ tính ngược</p></li>
<li><p>Khuếch tán: mỗi bit của khóa chính tác động lên tất cả khóa con</p></li>
</ul>
</section>
</section>
<section id="ket-luan">
<h2><span class="section-number">22.3.6. </span>Kết luận<a class="headerlink" href="#ket-luan" title="Link to this heading">#</a></h2>
<p>Mã hóa AES đơn giản và có thể chạy trên các chip 8 bit.</p>
<p>AES cung cấp ba biến thể cho độ dài khóa là:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(128\)</span> bit: <span class="math notranslate nohighlight">\(44\)</span> word <span class="math notranslate nohighlight">\(4\)</span> byte cho <span class="math notranslate nohighlight">\(10\)</span> vòng (<span class="math notranslate nohighlight">\(11\)</span> lần ARK)</p></li>
<li><p><span class="math notranslate nohighlight">\(192\)</span> bit: <span class="math notranslate nohighlight">\(52\)</span> word <span class="math notranslate nohighlight">\(4\)</span> byte cho <span class="math notranslate nohighlight">\(12\)</span> vòng (<span class="math notranslate nohighlight">\(13\)</span> lần ARK)</p></li>
<li><p><span class="math notranslate nohighlight">\(256\)</span> bit: <span class="math notranslate nohighlight">\(60\)</span> word <span class="math notranslate nohighlight">\(4\)</span> byte cho <span class="math notranslate nohighlight">\(14\)</span> vòng (<span class="math notranslate nohighlight">\(15\)</span> lần ARK)</p></li>
</ul>
</section>
<section id="ve-phep-mix-columns">
<h2><span class="section-number">22.3.7. </span>Về phép Mix Columns<a class="headerlink" href="#ve-phep-mix-columns" title="Link to this heading">#</a></h2>
<p>Sau đây mình sẽ nói về việc phép nhân trên đa thức có hệ số trong <span class="math notranslate nohighlight">\(\mathrm{GF}(2^8)\)</span> lại tương đương với phép nhân ma trận trong Mix Columns ở trên.</p>
<p>Giả sử ma trận trạng thái trước khi bước vào phép tính Mix Column của AES
là</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation*}
    \begin{pmatrix}
        c_0 &amp; c_1 &amp; c_2 &amp; c_3 \\
        c_4 &amp; c_5 &amp; c_6 &amp; c_7 \\
        c_8 &amp; c_9 &amp; c_{10} &amp; c_{11} \\
        c_{12} &amp; c_{13} &amp; c_{14} &amp; c_{15}
    \end{pmatrix}
\end{equation*}\end{split}\]</div>
<p>Phép tính Mix Column lấy mỗi cột của ma trận trạng thái trên làm tham số cho đa thức với hệ số trong <span class="math notranslate nohighlight">\(\mathrm{GF}(2^8)\)</span> và nhân với đa thức <span class="math notranslate nohighlight">\(c(z) = 2 + z + z^2 + 3z^3\)</span> rồi modulo cho <span class="math notranslate nohighlight">\(z^4 + 1\)</span>.</p>
<p>Giả sử với cột đầu tiên, ta viết hệ số theo thứ tự bậc tăng dần <span class="math notranslate nohighlight">\(d(z) = c_0 + c_4 z + c_8 z^2 + c_{12} z^3\)</span>.</p>
<p>Tính trong <span class="math notranslate nohighlight">\(\mathrm{GF}(2^8)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    c(z) \cdot d(z) = &amp; (2 + z + z^2 + 3 z^3) \cdot (c_0 + c_4 z + c_8 z^2 + c_{12} z^3) \\
    = &amp; 2 c_0 + 2 c_4 z + 2 c_8 z^2 + 2 c_{12} z^3 \\
    + &amp; c_0 z + c_4 z^2 + c_8 z^3 + c_{12} z^4 \\
    + &amp; c_0 z^2 + c_4 z^3 + c_8 z^4 + c_{12} z^5 \\
    + &amp; 3 c_0 z^3 + 3 c_4 z^4 + 3 c_8 z^5 + 3 c_{12} z^6 \\
    = &amp; 2 c_0 + (2 c_4 + c_0) z + (2 c_8 + c_4 + c_0) z^2 \\
    + &amp; (2 c_{12} + c_8 + c_4 + 3 c_0) z^3 + (c_{12} + c_8 + 3 c_4) z^4 \\
    + &amp; (c_{12} + 3 c_8) z^5 + 3 c_{12} z^6
\end{align*}\end{split}\]</div>
<p>Trong <span class="math notranslate nohighlight">\(\mathrm{GF}(2^8)\)</span> thì mọi phần tử đều có tính chất <span class="math notranslate nohighlight">\(2 x^n = 0\)</span>, tương đương với <span class="math notranslate nohighlight">\(x^n = -x^n\)</span>. Do đó</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    &amp; z^6 \pmod{z^4 + 1} \equiv -z^2 \equiv z^2 \\
    &amp; z^5 \pmod{z^4 + 1} \equiv -z \equiv z \\
    &amp; z^4 \pmod{z^4 + 1} \equiv -1 \equiv 1
\end{align*}\end{split}\]</div>
<p>Suy ra</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    c(z) \cdot d(z) = &amp; 2 c_0 + (2 c_4 + c_0) z + (2 c_8 + c_4 + c_0) z^2 \\
    + &amp; (2 c_{12} + c_8 + c_4 + 3 c_0) z^3 + (c_{12} + c_8 + 3 c_4) \\
    + &amp; (c_{12} + 3 c_8) z + 3 c_{12} z^2 \\
    = &amp; (c_{12} + c_8 + 3 c_4 + 2 c_0) + (c_{12} + 3 c_8 + 2 c_4 + c_0) z \\
    + &amp; (3 c_{12} + 2 c_8 + c_4 + c_0) z^2 + (2 c_{12} + c_8 + c_4 + 3 c_0) z^3
\end{align*}\end{split}\]</div>
<p>Như vậy xét hệ số lần lượt trước 1, <span class="math notranslate nohighlight">\(z\)</span>, <span class="math notranslate nohighlight">\(z^2\)</span> và <span class="math notranslate nohighlight">\(z^3\)</span> thì tương đương với phép
nhân ma trận</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation*}
    \begin{pmatrix}
        2 &amp; 3 &amp; 1 &amp; 1 \\
        1 &amp; 2 &amp; 3 &amp; 1 \\
        1 &amp; 1 &amp; 2 &amp; 3 \\
        3 &amp; 1 &amp; 1 &amp; 2
    \end{pmatrix} \cdot
    \begin{pmatrix}
        c_0 \\ c_4 \\ c_8 \\ c_{12}
    \end{pmatrix}
\end{equation*}\end{split}\]</div>
<p>Đây chính là kết quả cần tìm.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./cryptography"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="sms4.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">22.2. </span>SMS4</p>
      </div>
    </a>
    <a class="right-next"
       href="kuznyechik.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">22.4. </span>Kuznyechik</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#substitute-bytes">22.3.1. Substitute Bytes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">22.3.1.1. Substitute Bytes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-sub-bytes">22.3.1.2. Inverse Sub Bytes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#y-nghia-cua-substitute-bytes">22.3.1.3. Ý nghĩa của Substitute Bytes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shift-rows">22.3.2. Shift Rows</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">22.3.2.1. Shift Rows</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-shift-rows">22.3.2.2. Inverse Shift Rows</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#y-nghia">22.3.2.3. Ý nghĩa</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mix-columns">22.3.3. Mix Columns</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">22.3.3.1. Mix Columns</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-mix-columns">22.3.3.2. Inverse Mix Columns</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">22.3.3.3. Ý nghĩa</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-round-key">22.3.4. Add Round Key</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">22.3.4.1. Add Round Key</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">22.3.4.2. Ý nghĩa</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expand-key">22.3.5. Expand Key</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">22.3.5.1. Expand Key</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#y-nghia-cua-expand-key">22.3.5.2. Ý nghĩa của Expand Key</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ket-luan">22.3.6. Kết luận</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ve-phep-mix-columns">22.3.7. Về phép Mix Columns</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By myself
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>