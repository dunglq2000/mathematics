
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>CryptoFox 2024 &#8212; Math Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/myfile.css?v=564be945" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contests/2024/cryptofox-2024';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Abstract Algebra: Theory and Applications" href="../../solutions/Judson.html" />
    <link rel="prev" title="Internet Olympiad 2024" href="internet-olympiad-2024.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/Euler_Stamp.jpg" class="logo__image only-light" alt="Math Book - Home"/>
    <script>document.write(`<img src="../../_static/Euler_Stamp.jpg" class="logo__image only-dark" alt="Math Book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Toán học và những niềm đau
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Đại số</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../algebra/algebra.html">1. Đại cương về tập hợp</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../algebra/polynomial.html">2. Đa thức</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../algebra/lagrange-interpolation.html">2.1. Đa thức nội suy Lagrange</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../algebra/infinity.html">3. Sự vô hạn</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Đại số tuyến tính</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../linalg/intro.html">4. Ma trận</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Giải tích</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../calculus/calculus.html">5. Giải tích</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../calculus/series.html">5.5. Chuỗi số</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../calculus/partial-derivative.html">5.6. Đạo hàm một số hàm nhiều biến</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../calculus/differential-equation.html">6. Phương trình vi phân</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Xác suất</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../probability/intro.html">7. Xác suất thống kê</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Toán rời rạc</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../discrete-mathematics/group.html">8. Lý thuyết nhóm</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/group-intro.html">8.1. Nhóm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/symmetric-group.html">8.2. Nhóm hoán vị</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/group-homomorphism.html">8.3. Group homomorphism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/ring-and-field.html">8.4. Vành và trường</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/group-action.html">8.5. Tác động nhóm</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../discrete-mathematics/galois-theory.html">9. Lý thuyết Galois</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../discrete-mathematics/number-theory.html">10. Số học</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../discrete-mathematics/binary-relation.html">11. Quan hệ hai ngôi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../discrete-mathematics/partition.html">12. Phân hoạch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../discrete-mathematics/combinatoric.html">13. Đại cương tổ hợp</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../discrete-mathematics/boolean.html">14. Đại số boolean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/boolean-function.html">14.1. Hàm boolean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/walsh-hadamard-spectre.html">14.2. Trọng số, phổ Furier, phổ Walsh, Hamming distance</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Hình học</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../geometry/analytic-geometry.html">15. Hình học giải tích (theo góc nhìn không giải tích)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../geometry/transformation.html">16. Phép biến hình</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../geometry/conics.html">17. Ba đường Conic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../brachistochrone/brachistochrone.html">18. Đường đoản thời</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Mật mã học (và những niềm đau)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../cryptography/intro.html">19. Đại số boolean và mật mã học</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cryptography/stream-cipher.html">20. Stream cipher</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cryptography/linear-feedback-shift-register.html">20.1. Linear Feedback Shift Register</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cryptography/block-cipher.html">21. Block cipher</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cryptography/magma.html">21.1. Magma</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cryptography/sms4.html">21.2. SMS4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cryptography/AES.html">21.3. AES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cryptography/kuznyechik.html">21.4. Kuznyechik</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../cryptography/differential-attack/tinydes.html">22. Phá mã vi sai trên TinyDES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cryptography/quantum-computing.html">23. Quantum computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cryptography/lattice-based.html">24. Lattice-based cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cryptography/code-based.html">25. Code-based cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cryptography/elliptic.html">26. Đường cong elliptic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cryptography/discrete-logarithm.html">27. Discrete logarithm</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Теоретико-числовые алгоритмы в криптографии</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../vasilenko/intro.html">28. Теоретико-числовые алгоритмы в криптографии</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../vasilenko/discrete-fourier-transform.html">28.1. Biến đổi Fourier rời rạc</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Olympiad</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../2023/2023.html">2023</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023/internet-olympiad/2023.html">Internet Olympiad 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/siberian-maths-contest-2023.html">Siberian Mathematical Contest 2023</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="2024.html">2024</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="internet-olympiad-2024.html">Internet Olympiad 2024</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">CryptoFox 2024</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bài tập và lời giải</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../solutions/Judson.html">Abstract Algebra: Theory and Applications</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CTF</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../ctf/2020/2020.html">CTF 2020</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2020/midnightsunCTF-2020.html">Midnight Sun CTF 2020</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../ctf/2021/2021.html">CTF 2021</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2021/cryptoCTF-2021.html">Crypto CTF 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2021/googleCTF-2021.html">Google CTF 2021</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../ctf/2022/2022.html">CTF 2022</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2022/isitdtu-2022.html">ISITDTU Quals 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2022/downunderCTF-2022.html">DownUnder CTF 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2022/sekaiCTF-2022.html">Sekai CTF 2022</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../ctf/2023/2023.html">CTF 2023</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2023/AmateursCTF-2023.html">Amateurs CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2023/diceCTF-2023.html">Dice CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2023/googleCTF-2023.html">Google CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2023/backdoorCTF-2023.html">Backdoor CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2023/utctf-2023.html">UTCTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2023/wolvCTF-2023.html">Wolv CTF 2023</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../ctf/2024/2024.html">CTF 2024</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2024/0xL4ughCTF-2024.html">0xL4ugh CTF 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2024/TJCTF/TJCTF-2024-part-1.html">TJCTF 2024 phần 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2024/TJCTF/TJCTF-2024-part-2.html">TJCTF 2024 phần 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ctf/2024/TJCTF/TJCTF-2024-part-3.html">TJCTF 2024 phần 3</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Review sách</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../book-review/intro.html">Review sách</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../book-review/thien-tai-va-so-phan.html">Sách <em>Thiên tài và số phận</em></a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/dunglq2000/mathematics" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/dunglq2000/mathematics/issues/new?title=Issue%20on%20page%20%2Fcontests/2024/cryptofox-2024.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/contests/2024/cryptofox-2024.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>CryptoFox 2024</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Задача 1. дешифрование файла</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cau-hoi">Câu hỏi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loi-giai">Lời giải</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gost-cryptofox">Задача 2. Анализ GOST-CryptoFox</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phan-tich-gost-cryptofox">Phân tích GOST-CryptoFox</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thuat-toan-sinh-khoa-con">Thuật toán sinh khóa con</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thuat-toan-ma-hoa">Thuật toán mã hóa</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Câu hỏi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Задача 3. Инвариантные структуры</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Câu hỏi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Задача 4. Корректирующий код и шифр Вернама</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Câu hỏi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Задача 5. Эффективная реализация</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Câu hỏi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Задача 7. Диффенциальная равномерность</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Câu hỏi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Задача 8. Разделение секретов</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Câu hỏi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#s">Задача 9. Схемная сложность S-блока</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Câu hỏi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tryhard">Задача 10. Анализ алгоритма блочного шифрования «TryHard» (исследовательская)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Câu hỏi</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="cryptofox-2024">
<h1>CryptoFox 2024<a class="headerlink" href="#cryptofox-2024" title="Link to this heading">#</a></h1>
<p>Olympiad mật mã và bảo mật thông tin CryptoFox 2024</p>
<section id="id1">
<h2>Задача 1. дешифрование файла<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<section id="cau-hoi">
<h3>Câu hỏi<a class="headerlink" href="#cau-hoi" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os.path</span>		<span class="c1"># стандартная библиотека</span>
<span class="kn">import</span> <span class="nn">gostcrypto</span>	<span class="c1"># сторонняя библиотека (https://pypi.org/project/gostcrypto/)</span>

<span class="c1"># преобразование числа в двоичный массив</span>
<span class="k">def</span> <span class="nf">bitlist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">512</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>

<span class="c1"># преобразование двоичного массива в число</span>
<span class="k">def</span> <span class="nf">bittoint</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">res</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">bit</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="c1"># определение перестановки</span>
<span class="n">perm</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">35</span><span class="p">,</span>	 <span class="mi">39</span><span class="p">,</span>	<span class="mi">326</span><span class="p">,</span>	<span class="mi">478</span><span class="p">,</span>	<span class="mi">507</span><span class="p">,</span>	<span class="mi">299</span><span class="p">,</span>	<span class="mi">233</span><span class="p">,</span>	 <span class="mi">47</span><span class="p">,</span>
		  <span class="mi">7</span><span class="p">,</span>	 <span class="mi">56</span><span class="p">,</span>	<span class="mi">293</span><span class="p">,</span>	<span class="mi">383</span><span class="p">,</span>	<span class="mi">322</span><span class="p">,</span>	<span class="mi">354</span><span class="p">,</span>	<span class="mi">185</span><span class="p">,</span>	<span class="mi">385</span><span class="p">,</span>
		<span class="mi">104</span><span class="p">,</span>	<span class="mi">414</span><span class="p">,</span>	 <span class="mi">66</span><span class="p">,</span>	<span class="mi">267</span><span class="p">,</span>	<span class="mi">106</span><span class="p">,</span>	<span class="mi">475</span><span class="p">,</span>	<span class="mi">101</span><span class="p">,</span>	<span class="mi">212</span><span class="p">,</span>
		<span class="mi">270</span><span class="p">,</span>	 <span class="mi">26</span><span class="p">,</span>	<span class="mi">398</span><span class="p">,</span>	<span class="mi">490</span><span class="p">,</span>	<span class="mi">496</span><span class="p">,</span>	<span class="mi">131</span><span class="p">,</span>	 <span class="mi">72</span><span class="p">,</span>	<span class="mi">495</span><span class="p">,</span>
		<span class="mi">186</span><span class="p">,</span>	<span class="mi">168</span><span class="p">,</span>	<span class="mi">509</span><span class="p">,</span>	 <span class="mi">27</span><span class="p">,</span>	<span class="mi">196</span><span class="p">,</span>	<span class="mi">437</span><span class="p">,</span>	<span class="mi">401</span><span class="p">,</span>	<span class="mi">194</span><span class="p">,</span>
		<span class="mi">200</span><span class="p">,</span>	<span class="mi">405</span><span class="p">,</span>	<span class="mi">176</span><span class="p">,</span>	<span class="mi">422</span><span class="p">,</span>	<span class="mi">294</span><span class="p">,</span>	<span class="mi">145</span><span class="p">,</span>	<span class="mi">370</span><span class="p">,</span>	<span class="mi">237</span><span class="p">,</span>
		 <span class="mi">12</span><span class="p">,</span>	<span class="mi">246</span><span class="p">,</span>	<span class="mi">152</span><span class="p">,</span>	 <span class="mi">40</span><span class="p">,</span>	<span class="mi">403</span><span class="p">,</span>	<span class="mi">482</span><span class="p">,</span>	<span class="mi">471</span><span class="p">,</span>	<span class="mi">328</span><span class="p">,</span>
		<span class="mi">153</span><span class="p">,</span>	<span class="mi">183</span><span class="p">,</span>	<span class="mi">487</span><span class="p">,</span>	 <span class="mi">34</span><span class="p">,</span>	<span class="mi">484</span><span class="p">,</span>	<span class="mi">260</span><span class="p">,</span>	 <span class="mi">91</span><span class="p">,</span>	<span class="mi">397</span><span class="p">,</span>
		<span class="mi">340</span><span class="p">,</span>	 <span class="mi">15</span><span class="p">,</span>	<span class="mi">446</span><span class="p">,</span>	  <span class="mi">0</span><span class="p">,</span>	<span class="mi">273</span><span class="p">,</span>	<span class="mi">389</span><span class="p">,</span>	<span class="mi">266</span><span class="p">,</span>	<span class="mi">268</span><span class="p">,</span>
		<span class="mi">117</span><span class="p">,</span>	<span class="mi">361</span><span class="p">,</span>	<span class="mi">468</span><span class="p">,</span>	 <span class="mi">11</span><span class="p">,</span>	 <span class="mi">74</span><span class="p">,</span>	<span class="mi">141</span><span class="p">,</span>	 <span class="mi">52</span><span class="p">,</span>	<span class="mi">254</span><span class="p">,</span>
		<span class="mi">486</span><span class="p">,</span>	 <span class="mi">71</span><span class="p">,</span>	<span class="mi">277</span><span class="p">,</span>	<span class="mi">307</span><span class="p">,</span>	<span class="mi">419</span><span class="p">,</span>	<span class="mi">501</span><span class="p">,</span>	<span class="mi">489</span><span class="p">,</span>	<span class="mi">164</span><span class="p">,</span>
		<span class="mi">384</span><span class="p">,</span>	<span class="mi">362</span><span class="p">,</span>	<span class="mi">349</span><span class="p">,</span>	<span class="mi">210</span><span class="p">,</span>	<span class="mi">171</span><span class="p">,</span>	<span class="mi">187</span><span class="p">,</span>	 <span class="mi">76</span><span class="p">,</span>	<span class="mi">418</span><span class="p">,</span>
		<span class="mi">220</span><span class="p">,</span>	 <span class="mi">97</span><span class="p">,</span>	<span class="mi">315</span><span class="p">,</span>	 <span class="mi">19</span><span class="p">,</span>	<span class="mi">209</span><span class="p">,</span>	<span class="mi">312</span><span class="p">,</span>	<span class="mi">257</span><span class="p">,</span>	<span class="mi">402</span><span class="p">,</span>
		<span class="mi">500</span><span class="p">,</span>	<span class="mi">400</span><span class="p">,</span>	<span class="mi">216</span><span class="p">,</span>	<span class="mi">232</span><span class="p">,</span>	<span class="mi">463</span><span class="p">,</span>	<span class="mi">424</span><span class="p">,</span>	<span class="mi">314</span><span class="p">,</span>	<span class="mi">128</span><span class="p">,</span>
		 <span class="mi">58</span><span class="p">,</span>	<span class="mi">493</span><span class="p">,</span>	 <span class="mi">17</span><span class="p">,</span>	<span class="mi">258</span><span class="p">,</span>	 <span class="mi">55</span><span class="p">,</span>	<span class="mi">433</span><span class="p">,</span>	<span class="mi">316</span><span class="p">,</span>	<span class="mi">166</span><span class="p">,</span>
		<span class="mi">503</span><span class="p">,</span>	<span class="mi">479</span><span class="p">,</span>	<span class="mi">173</span><span class="p">,</span>	<span class="mi">208</span><span class="p">,</span>	<span class="mi">491</span><span class="p">,</span>	<span class="mi">416</span><span class="p">,</span>	<span class="mi">498</span><span class="p">,</span>	<span class="mi">231</span><span class="p">,</span>
		<span class="mi">159</span><span class="p">,</span>	<span class="mi">415</span><span class="p">,</span>	<span class="mi">359</span><span class="p">,</span>	<span class="mi">342</span><span class="p">,</span>	<span class="mi">310</span><span class="p">,</span>	<span class="mi">235</span><span class="p">,</span>	<span class="mi">123</span><span class="p">,</span>	<span class="mi">244</span><span class="p">,</span>
		<span class="mi">122</span><span class="p">,</span>	 <span class="mi">23</span><span class="p">,</span>	<span class="mi">129</span><span class="p">,</span>	<span class="mi">440</span><span class="p">,</span>	<span class="mi">508</span><span class="p">,</span>	<span class="mi">308</span><span class="p">,</span>	<span class="mi">338</span><span class="p">,</span>	<span class="mi">189</span><span class="p">,</span>
		 <span class="mi">68</span><span class="p">,</span>	<span class="mi">452</span><span class="p">,</span>	<span class="mi">214</span><span class="p">,</span>	<span class="mi">240</span><span class="p">,</span>	<span class="mi">155</span><span class="p">,</span>	<span class="mi">480</span><span class="p">,</span>	<span class="mi">462</span><span class="p">,</span>	<span class="mi">180</span><span class="p">,</span>
		<span class="mi">298</span><span class="p">,</span>	 <span class="mi">21</span><span class="p">,</span>	<span class="mi">313</span><span class="p">,</span>	<span class="mi">248</span><span class="p">,</span>	<span class="mi">396</span><span class="p">,</span>	<span class="mi">285</span><span class="p">,</span>	<span class="mi">388</span><span class="p">,</span>	 <span class="mi">37</span><span class="p">,</span>
		<span class="mi">286</span><span class="p">,</span>	 <span class="mi">84</span><span class="p">,</span>	 <span class="mi">81</span><span class="p">,</span>	<span class="mi">134</span><span class="p">,</span>	 <span class="mi">96</span><span class="p">,</span>	<span class="mi">223</span><span class="p">,</span>	<span class="mi">505</span><span class="p">,</span>	<span class="mi">256</span><span class="p">,</span>
		 <span class="mi">87</span><span class="p">,</span>	<span class="mi">234</span><span class="p">,</span>	<span class="mi">262</span><span class="p">,</span>	  <span class="mi">9</span><span class="p">,</span>	<span class="mi">343</span><span class="p">,</span>	<span class="mi">390</span><span class="p">,</span>	<span class="mi">410</span><span class="p">,</span>	<span class="mi">455</span><span class="p">,</span>
		 <span class="mi">67</span><span class="p">,</span>	<span class="mi">236</span><span class="p">,</span>	<span class="mi">466</span><span class="p">,</span>	<span class="mi">103</span><span class="p">,</span>	<span class="mi">356</span><span class="p">,</span>	<span class="mi">279</span><span class="p">,</span>	<span class="mi">339</span><span class="p">,</span>	<span class="mi">109</span><span class="p">,</span>
		 <span class="mi">73</span><span class="p">,</span>	<span class="mi">222</span><span class="p">,</span>	<span class="mi">269</span><span class="p">,</span>	<span class="mi">351</span><span class="p">,</span>	<span class="mi">469</span><span class="p">,</span>	 <span class="mi">98</span><span class="p">,</span>	  <span class="mi">5</span><span class="p">,</span>	<span class="mi">100</span><span class="p">,</span>
		<span class="mi">348</span><span class="p">,</span>	 <span class="mi">62</span><span class="p">,</span>	<span class="mi">317</span><span class="p">,</span>	<span class="mi">241</span><span class="p">,</span>	<span class="mi">499</span><span class="p">,</span>	 <span class="mi">43</span><span class="p">,</span>	<span class="mi">197</span><span class="p">,</span>	 <span class="mi">54</span><span class="p">,</span>
		<span class="mi">448</span><span class="p">,</span>	 <span class="mi">60</span><span class="p">,</span>	<span class="mi">114</span><span class="p">,</span>	<span class="mi">332</span><span class="p">,</span>	<span class="mi">191</span><span class="p">,</span>	<span class="mi">250</span><span class="p">,</span>	<span class="mi">311</span><span class="p">,</span>	<span class="mi">395</span><span class="p">,</span>
		 <span class="mi">48</span><span class="p">,</span>	<span class="mi">465</span><span class="p">,</span>	 <span class="mi">24</span><span class="p">,</span>	<span class="mi">172</span><span class="p">,</span>	  <span class="mi">6</span><span class="p">,</span>	<span class="mi">436</span><span class="p">,</span>	 <span class="mi">16</span><span class="p">,</span>	 <span class="mi">65</span><span class="p">,</span>
		<span class="mi">177</span><span class="p">,</span>	<span class="mi">225</span><span class="p">,</span>	<span class="mi">358</span><span class="p">,</span>	 <span class="mi">44</span><span class="p">,</span>	<span class="mi">423</span><span class="p">,</span>	<span class="mi">439</span><span class="p">,</span>	 <span class="mi">95</span><span class="p">,</span>	<span class="mi">318</span><span class="p">,</span>
		<span class="mi">198</span><span class="p">,</span>	<span class="mi">330</span><span class="p">,</span>	<span class="mi">178</span><span class="p">,</span>	<span class="mi">179</span><span class="p">,</span>	 <span class="mi">20</span><span class="p">,</span>	<span class="mi">249</span><span class="p">,</span>	 <span class="mi">90</span><span class="p">,</span>	<span class="mi">261</span><span class="p">,</span>
		 <span class="mi">88</span><span class="p">,</span>	<span class="mi">450</span><span class="p">,</span>	<span class="mi">127</span><span class="p">,</span>	<span class="mi">137</span><span class="p">,</span>	<span class="mi">502</span><span class="p">,</span>	<span class="mi">263</span><span class="p">,</span>	 <span class="mi">63</span><span class="p">,</span>	 <span class="mi">32</span><span class="p">,</span>
		<span class="mi">219</span><span class="p">,</span>	<span class="mi">407</span><span class="p">,</span>	<span class="mi">453</span><span class="p">,</span>	<span class="mi">369</span><span class="p">,</span>	<span class="mi">175</span><span class="p">,</span>	<span class="mi">271</span><span class="p">,</span>	 <span class="mi">31</span><span class="p">,</span>	<span class="mi">230</span><span class="p">,</span>
		<span class="mi">346</span><span class="p">,</span>	 <span class="mi">59</span><span class="p">,</span>	 <span class="mi">61</span><span class="p">,</span>	<span class="mi">292</span><span class="p">,</span>	<span class="mi">213</span><span class="p">,</span>	<span class="mi">281</span><span class="p">,</span>	<span class="mi">290</span><span class="p">,</span>	<span class="mi">406</span><span class="p">,</span>
		<span class="mi">425</span><span class="p">,</span>	<span class="mi">297</span><span class="p">,</span>	<span class="mi">381</span><span class="p">,</span>	<span class="mi">142</span><span class="p">,</span>	<span class="mi">108</span><span class="p">,</span>	<span class="mi">203</span><span class="p">,</span>	<span class="mi">295</span><span class="p">,</span>	<span class="mi">411</span><span class="p">,</span>
		<span class="mi">485</span><span class="p">,</span>	<span class="mi">459</span><span class="p">,</span>	 <span class="mi">28</span><span class="p">,</span>	<span class="mi">387</span><span class="p">,</span>	<span class="mi">302</span><span class="p">,</span>	<span class="mi">464</span><span class="p">,</span>	<span class="mi">327</span><span class="p">,</span>	<span class="mi">429</span><span class="p">,</span>
		<span class="mi">125</span><span class="p">,</span>	<span class="mi">205</span><span class="p">,</span>	<span class="mi">243</span><span class="p">,</span>	<span class="mi">379</span><span class="p">,</span>	<span class="mi">454</span><span class="p">,</span>	 <span class="mi">85</span><span class="p">,</span>	<span class="mi">510</span><span class="p">,</span>	 <span class="mi">14</span><span class="p">,</span>
		<span class="mi">215</span><span class="p">,</span>	<span class="mi">255</span><span class="p">,</span>	<span class="mi">300</span><span class="p">,</span>	  <span class="mi">8</span><span class="p">,</span>	<span class="mi">275</span><span class="p">,</span>	<span class="mi">193</span><span class="p">,</span>	<span class="mi">169</span><span class="p">,</span>	 <span class="mi">22</span><span class="p">,</span>
		<span class="mi">494</span><span class="p">,</span>	<span class="mi">276</span><span class="p">,</span>	<span class="mi">372</span><span class="p">,</span>	<span class="mi">224</span><span class="p">,</span>	<span class="mi">207</span><span class="p">,</span>	<span class="mi">336</span><span class="p">,</span>	<span class="mi">363</span><span class="p">,</span>	<span class="mi">148</span><span class="p">,</span>
		<span class="mi">247</span><span class="p">,</span>	<span class="mi">124</span><span class="p">,</span>	<span class="mi">427</span><span class="p">,</span>	<span class="mi">229</span><span class="p">,</span>	<span class="mi">296</span><span class="p">,</span>	<span class="mi">504</span><span class="p">,</span>	<span class="mi">420</span><span class="p">,</span>	<span class="mi">353</span><span class="p">,</span>
		<span class="mi">280</span><span class="p">,</span>	<span class="mi">116</span><span class="p">,</span>	<span class="mi">284</span><span class="p">,</span>	<span class="mi">150</span><span class="p">,</span>	<span class="mi">481</span><span class="p">,</span>	<span class="mi">154</span><span class="p">,</span>	 <span class="mi">93</span><span class="p">,</span>	 <span class="mi">30</span><span class="p">,</span>
		<span class="mi">272</span><span class="p">,</span>	<span class="mi">331</span><span class="p">,</span>	<span class="mi">252</span><span class="p">,</span>	<span class="mi">378</span><span class="p">,</span>	<span class="mi">320</span><span class="p">,</span>	<span class="mi">421</span><span class="p">,</span>	 <span class="mi">83</span><span class="p">,</span>	<span class="mi">443</span><span class="p">,</span>
		<span class="mi">374</span><span class="p">,</span>	<span class="mi">289</span><span class="p">,</span>	<span class="mi">163</span><span class="p">,</span>	<span class="mi">511</span><span class="p">,</span>	 <span class="mi">99</span><span class="p">,</span>	<span class="mi">304</span><span class="p">,</span>	<span class="mi">451</span><span class="p">,</span>	<span class="mi">253</span><span class="p">,</span>
		<span class="mi">474</span><span class="p">,</span>	<span class="mi">303</span><span class="p">,</span>	 <span class="mi">38</span><span class="p">,</span>	  <span class="mi">2</span><span class="p">,</span>	 <span class="mi">53</span><span class="p">,</span>	 <span class="mi">89</span><span class="p">,</span>	<span class="mi">329</span><span class="p">,</span>	<span class="mi">447</span><span class="p">,</span>
		 <span class="mi">41</span><span class="p">,</span>	 <span class="mi">57</span><span class="p">,</span>	<span class="mi">199</span><span class="p">,</span>	 <span class="mi">51</span><span class="p">,</span>	 <span class="mi">77</span><span class="p">,</span>	<span class="mi">151</span><span class="p">,</span>	<span class="mi">288</span><span class="p">,</span>	<span class="mi">412</span><span class="p">,</span>
		<span class="mi">147</span><span class="p">,</span>	<span class="mi">161</span><span class="p">,</span>	 <span class="mi">18</span><span class="p">,</span>	<span class="mi">426</span><span class="p">,</span>	<span class="mi">376</span><span class="p">,</span>	<span class="mi">352</span><span class="p">,</span>	<span class="mi">394</span><span class="p">,</span>	<span class="mi">497</span><span class="p">,</span>
		<span class="mi">375</span><span class="p">,</span>	<span class="mi">399</span><span class="p">,</span>	<span class="mi">245</span><span class="p">,</span>	<span class="mi">140</span><span class="p">,</span>	<span class="mi">506</span><span class="p">,</span>	<span class="mi">132</span><span class="p">,</span>	<span class="mi">409</span><span class="p">,</span>	<span class="mi">221</span><span class="p">,</span>
		 <span class="mi">10</span><span class="p">,</span>	<span class="mi">366</span><span class="p">,</span>	<span class="mi">165</span><span class="p">,</span>	<span class="mi">477</span><span class="p">,</span>	<span class="mi">357</span><span class="p">,</span>	<span class="mi">120</span><span class="p">,</span>	<span class="mi">373</span><span class="p">,</span>	<span class="mi">156</span><span class="p">,</span>
		<span class="mi">188</span><span class="p">,</span>	<span class="mi">333</span><span class="p">,</span>	<span class="mi">344</span><span class="p">,</span>	<span class="mi">102</span><span class="p">,</span>	<span class="mi">170</span><span class="p">,</span>	<span class="mi">325</span><span class="p">,</span>	<span class="mi">264</span><span class="p">,</span>	<span class="mi">239</span><span class="p">,</span>
		 <span class="mi">29</span><span class="p">,</span>	<span class="mi">392</span><span class="p">,</span>	<span class="mi">118</span><span class="p">,</span>	<span class="mi">227</span><span class="p">,</span>	 <span class="mi">64</span><span class="p">,</span>	 <span class="mi">86</span><span class="p">,</span>	<span class="mi">174</span><span class="p">,</span>	<span class="mi">274</span><span class="p">,</span>
		<span class="mi">130</span><span class="p">,</span>	<span class="mi">211</span><span class="p">,</span>	 <span class="mi">75</span><span class="p">,</span>	<span class="mi">287</span><span class="p">,</span>	 <span class="mi">78</span><span class="p">,</span>	<span class="mi">111</span><span class="p">,</span>	  <span class="mi">3</span><span class="p">,</span>	<span class="mi">291</span><span class="p">,</span>
		 <span class="mi">79</span><span class="p">,</span>	<span class="mi">135</span><span class="p">,</span>	 <span class="mi">94</span><span class="p">,</span>	<span class="mi">335</span><span class="p">,</span>	<span class="mi">228</span><span class="p">,</span>	 <span class="mi">42</span><span class="p">,</span>	<span class="mi">337</span><span class="p">,</span>	 <span class="mi">45</span><span class="p">,</span>
		<span class="mi">195</span><span class="p">,</span>	<span class="mi">259</span><span class="p">,</span>	<span class="mi">441</span><span class="p">,</span>	<span class="mi">404</span><span class="p">,</span>	 <span class="mi">33</span><span class="p">,</span>	<span class="mi">432</span><span class="p">,</span>	<span class="mi">380</span><span class="p">,</span>	<span class="mi">133</span><span class="p">,</span>
		<span class="mi">467</span><span class="p">,</span>	<span class="mi">144</span><span class="p">,</span>	<span class="mi">309</span><span class="p">,</span>	  <span class="mi">4</span><span class="p">,</span>	<span class="mi">226</span><span class="p">,</span>	<span class="mi">251</span><span class="p">,</span>	<span class="mi">121</span><span class="p">,</span>	<span class="mi">435</span><span class="p">,</span>
		<span class="mi">319</span><span class="p">,</span>	<span class="mi">386</span><span class="p">,</span>	<span class="mi">306</span><span class="p">,</span>	 <span class="mi">92</span><span class="p">,</span>	<span class="mi">321</span><span class="p">,</span>	<span class="mi">182</span><span class="p">,</span>	<span class="mi">167</span><span class="p">,</span>	<span class="mi">126</span><span class="p">,</span>
		<span class="mi">242</span><span class="p">,</span>	<span class="mi">434</span><span class="p">,</span>	<span class="mi">113</span><span class="p">,</span>	<span class="mi">367</span><span class="p">,</span>	<span class="mi">107</span><span class="p">,</span>	<span class="mi">355</span><span class="p">,</span>	<span class="mi">483</span><span class="p">,</span>	<span class="mi">204</span><span class="p">,</span>
		<span class="mi">456</span><span class="p">,</span>	<span class="mi">282</span><span class="p">,</span>	<span class="mi">350</span><span class="p">,</span>	<span class="mi">408</span><span class="p">,</span>	<span class="mi">238</span><span class="p">,</span>	<span class="mi">334</span><span class="p">,</span>	<span class="mi">301</span><span class="p">,</span>	<span class="mi">364</span><span class="p">,</span>
		<span class="mi">138</span><span class="p">,</span>	<span class="mi">428</span><span class="p">,</span>	<span class="mi">105</span><span class="p">,</span>	<span class="mi">431</span><span class="p">,</span>	<span class="mi">460</span><span class="p">,</span>	 <span class="mi">82</span><span class="p">,</span>	<span class="mi">115</span><span class="p">,</span>	<span class="mi">341</span><span class="p">,</span>
		<span class="mi">430</span><span class="p">,</span>	<span class="mi">278</span><span class="p">,</span>	<span class="mi">190</span><span class="p">,</span>	<span class="mi">143</span><span class="p">,</span>	 <span class="mi">46</span><span class="p">,</span>	<span class="mi">473</span><span class="p">,</span>	<span class="mi">110</span><span class="p">,</span>	<span class="mi">445</span><span class="p">,</span>
		  <span class="mi">1</span><span class="p">,</span>	 <span class="mi">69</span><span class="p">,</span>	 <span class="mi">25</span><span class="p">,</span>	<span class="mi">201</span><span class="p">,</span>	<span class="mi">438</span><span class="p">,</span>	<span class="mi">393</span><span class="p">,</span>	<span class="mi">184</span><span class="p">,</span>	<span class="mi">323</span><span class="p">,</span>
		<span class="mi">265</span><span class="p">,</span>	<span class="mi">444</span><span class="p">,</span>	<span class="mi">149</span><span class="p">,</span>	<span class="mi">136</span><span class="p">,</span>	<span class="mi">476</span><span class="p">,</span>	<span class="mi">368</span><span class="p">,</span>	<span class="mi">365</span><span class="p">,</span>	<span class="mi">488</span><span class="p">,</span>
		<span class="mi">371</span><span class="p">,</span>	<span class="mi">472</span><span class="p">,</span>	<span class="mi">324</span><span class="p">,</span>	<span class="mi">360</span><span class="p">,</span>	<span class="mi">202</span><span class="p">,</span>	 <span class="mi">50</span><span class="p">,</span>	 <span class="mi">49</span><span class="p">,</span>	<span class="mi">305</span><span class="p">,</span>
		<span class="mi">206</span><span class="p">,</span>	 <span class="mi">36</span><span class="p">,</span>	<span class="mi">158</span><span class="p">,</span>	<span class="mi">492</span><span class="p">,</span>	<span class="mi">181</span><span class="p">,</span>	<span class="mi">391</span><span class="p">,</span>	 <span class="mi">13</span><span class="p">,</span>	<span class="mi">217</span><span class="p">,</span>
		<span class="mi">218</span><span class="p">,</span>	<span class="mi">157</span><span class="p">,</span>	 <span class="mi">80</span><span class="p">,</span>	<span class="mi">119</span><span class="p">,</span>	<span class="mi">377</span><span class="p">,</span>	<span class="mi">382</span><span class="p">,</span>	<span class="mi">160</span><span class="p">,</span>	<span class="mi">442</span><span class="p">,</span>
		<span class="mi">449</span><span class="p">,</span>	<span class="mi">146</span><span class="p">,</span>	<span class="mi">345</span><span class="p">,</span>	<span class="mi">139</span><span class="p">,</span>	<span class="mi">283</span><span class="p">,</span>	<span class="mi">112</span><span class="p">,</span>	<span class="mi">192</span><span class="p">,</span>	<span class="mi">461</span><span class="p">,</span>
		<span class="mi">458</span><span class="p">,</span>	<span class="mi">457</span><span class="p">,</span>	<span class="mi">470</span><span class="p">,</span>	<span class="mi">413</span><span class="p">,</span>	<span class="mi">417</span><span class="p">,</span>	<span class="mi">162</span><span class="p">,</span>	 <span class="mi">70</span><span class="p">,</span>	<span class="mi">347</span><span class="p">]</span>

<span class="c1"># инициализационный вектор шифрования</span>
<span class="n">iv</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span><span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">])</span>

<span class="c1"># перестановка битов числа</span>
<span class="k">def</span> <span class="nf">intpermute</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">bitlist</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
        <span class="n">res</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">bittoint</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="c1"># преобразование пароля в ключ</span>
<span class="k">def</span> <span class="nf">pwdtokey</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="nb">str</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;cp1251&#39;</span><span class="p">)</span>
    <span class="nb">hash</span> <span class="o">=</span> <span class="n">gostcrypto</span><span class="o">.</span><span class="n">gosthash</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;streebog512&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="nb">hash</span><span class="o">.</span><span class="n">digest</span><span class="p">(),</span><span class="s2">&quot;big&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">intpermute</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">%</span> <span class="mi">115792089237316195423570985008687907853269984665640564039457584007913129639936</span>
    <span class="k">return</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;big&quot;</span><span class="p">))</span>

<span class="c1"># зашифрование файла</span>
<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">plain_file_path</span> <span class="p">,</span> <span class="n">cipher_file_path</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="n">cipher_obj</span> <span class="o">=</span> <span class="n">gostcrypto</span><span class="o">.</span><span class="n">gostcipher</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;kuznechik&#39;</span><span class="p">,</span>
                                       <span class="n">key</span><span class="p">,</span>
                                       <span class="n">gostcrypto</span><span class="o">.</span><span class="n">gostcipher</span><span class="o">.</span><span class="n">MODE_CTR</span><span class="p">,</span>
                                       <span class="n">init_vect</span><span class="o">=</span><span class="n">iv</span><span class="p">)</span>
    <span class="n">buffer_size</span> <span class="o">=</span> <span class="mi">128</span>
    <span class="n">plain_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">plain_file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
    <span class="n">cipher_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">cipher_file_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span>
    <span class="n">buffer</span> <span class="o">=</span> <span class="n">plain_file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">)</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">cipher_data</span> <span class="o">=</span> <span class="n">cipher_obj</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
        <span class="n">cipher_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cipher_data</span><span class="p">)</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="n">plain_file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">)</span>
    <span class="k">return</span>

<span class="c1"># расшифрование файла</span>
<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">cipher_file_path</span><span class="p">,</span> <span class="n">plain_file_path</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="n">cipher_obj</span> <span class="o">=</span> <span class="n">gostcrypto</span><span class="o">.</span><span class="n">gostcipher</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;kuznechik&#39;</span><span class="p">,</span>
                                       <span class="n">key</span><span class="p">,</span>
                                       <span class="n">gostcrypto</span><span class="o">.</span><span class="n">gostcipher</span><span class="o">.</span><span class="n">MODE_CTR</span><span class="p">,</span>
                                       <span class="n">init_vect</span><span class="o">=</span><span class="n">iv</span><span class="p">)</span>
    <span class="n">buffer_size</span> <span class="o">=</span> <span class="mi">128</span>
    <span class="n">cipher_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">cipher_file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
    <span class="n">plain_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">plain_file_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span>
    <span class="n">buffer</span> <span class="o">=</span> <span class="n">cipher_file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">)</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plain_data</span> <span class="o">=</span> <span class="n">cipher_obj</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
        <span class="n">plain_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">plain_data</span><span class="p">)</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="n">cipher_file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">)</span>
    <span class="k">return</span>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;некий пароль&quot;</span>   <span class="c1"># здесь был пароль</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">pwdtokey</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>      <span class="c1"># преобразовываем пароль в ключ</span>

    <span class="n">plain_file_path</span> <span class="o">=</span> <span class="s1">&#39;plain_file.txt&#39;</span>  <span class="c1"># файл исходного ОТ</span>
    <span class="n">cipher_file_path</span> <span class="o">=</span> <span class="s1">&#39;cipher_file.txt&#39;</span>    <span class="c1"># файл для записи ШТ</span>
    <span class="n">decipher_file_path</span> <span class="o">=</span> <span class="s1">&#39;decipher_file.txt&#39;</span>    <span class="c1"># файл полученного ОТ</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">plain_file_path</span><span class="p">):</span>
        <span class="n">encrypt</span><span class="p">(</span><span class="n">plain_file_path</span><span class="p">,</span> <span class="n">cipher_file_path</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>  <span class="c1"># зашифрование ОТ</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">cipher_file_path</span><span class="p">):</span>
        <span class="n">decrypt</span><span class="p">(</span><span class="n">cipher_file_path</span><span class="p">,</span> <span class="n">decipher_file_path</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>    <span class="c1"># расшифрование ШТ</span>
</pre></div>
</div>
</section>
<section id="loi-giai">
<h3>Lời giải<a class="headerlink" href="#loi-giai" title="Link to this heading">#</a></h3>
<p>Bài này cho file encrypt bằng thuật toán Kuznyechik 256 bit. Với password bị ẩn đi, khóa cho Kuznyechik được sinh bằng việc hash password bằng Streebog, sau đó các bit sau khi hash đi qua một hoán vị.</p>
<p>Do Streebog là hash 512 bit nên sau khi qua bảng hoán vị vẫn có 512 bit. Do đó khóa là 256 bit thấp sau khi hash.</p>
<p>Cả Streebog và Kuznyechik là các tiêu chuẩn mật mã nên không thể phá. Lỗi nằm ở bảng hoán vị.</p>
<p>Sau khi thử tạo key từ một số password (tiếng Nga), ta thấy rằng trong 256 bit của khóa chỉ có một số ít bit 1. Đặc biệt là các vị trí xuất hiện 1 là không nhiều. Do đó chúng ta có thể giảm không gian 256 bit xuống một tập nhỏ hơn.</p>
<p>Giả sử ta tạo các key Kuznyechik <span class="math notranslate nohighlight">\(K_1, K_2, \ldots\)</span> từ việc hash các password <span class="math notranslate nohighlight">\(w_1, w_2, \ldots\)</span>, nghĩa là <span class="math notranslate nohighlight">\(K_i = H(w_i)\)</span>, đặt <span class="math notranslate nohighlight">\(I_i\)</span> là tập hợp các vị trí bit 1 xuất hiện.</p>
<p>Đặt <span class="math notranslate nohighlight">\(I = I_1 \cup I_2 \cup \ldots\)</span> là tập các vị trí có thể là bit 1 khi hash một password bất kì. Tập này chứa không quá 10 phần tử.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>
<span class="kn">import</span> <span class="nn">string</span>

<span class="c1"># Здесь найти позиции, где возможно появится единицы</span>
<span class="n">alphabet</span> <span class="o">=</span> <span class="s1">&#39;АБВГДЕЁЖЗИЙКЛМНОРПСТУФХЦЧШЩЪЫЬЭЮЯабвгдеёжзийabcdefghijklmn0123456789&#39;</span>
<span class="n">ss</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">pwd</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span> <span class="k">for</span> <span class="n">__</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">)])</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">pwdtokey</span><span class="p">(</span><span class="n">pwd</span><span class="p">)</span>
    <span class="n">bits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
	<span class="n">bits</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{:08b}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">b</span><span class="p">))))</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">bits</span><span class="p">)</span> <span class="o">==</span> <span class="mi">256</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">bits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">ss</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</pre></div>
</div>
<p>Khi đó khóa Kuznyechik để mã hóa sẽ là khóa có bit 1 nằm ở các vị trí theo tập <span class="math notranslate nohighlight">\(J \subset I\)</span>. Thử tất cả tập con của <span class="math notranslate nohighlight">\(I\)</span> đến khi decrypt và decode thành công.</p>
<p>Khóa decrypt viết ở dạng hex là</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0000e00000000080000000000000000000000004000000000000004000000004</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>
<span class="kn">import</span> <span class="nn">string</span>

<span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;cipher_file.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="n">ciphertext</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">ss</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">128</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">253</span><span class="p">,</span> <span class="mi">159</span><span class="p">])</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ss</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ss</span><span class="p">),</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">kk</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">comb</span><span class="p">:</span> <span class="n">kk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">kk</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">8</span><span class="p">)]</span>
        <span class="n">key</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">)</span>
        <span class="n">cipher_obj</span> <span class="o">=</span> <span class="n">gostcrypto</span><span class="o">.</span><span class="n">gostcipher</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
            <span class="s1">&#39;kuznechik&#39;</span><span class="p">,</span> 
            <span class="n">key</span><span class="p">,</span> 
            <span class="n">gostcrypto</span><span class="o">.</span><span class="n">gostcipher</span><span class="o">.</span><span class="n">MODE_CTR</span><span class="p">,</span> 
            <span class="n">init_vect</span><span class="o">=</span><span class="n">iv</span><span class="p">)</span>
        <span class="n">plaintext</span> <span class="o">=</span> <span class="n">cipher_obj</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">plaintext</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
</pre></div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Kết quả (thơ tiếng Nga)</p>
<p>Мой дядя самых честных правил,</p>
<p>Когда не в шутку занемог,</p>
<p>Он уважать себя заставил</p>
<p>И лучше выдумать не мог.</p>
<p>Его пример другим наука;</p>
<p>Но, боже мой, какая скука</p>
<p>С больным сидеть и день и ночь,</p>
<p>Не отходя ни шагу прочь!</p>
<p>Какое низкое коварство</p>
<p>Полуживого забавлять,</p>
<p>Ему подушки поправлять,</p>
<p>Печально подносить лекарство,</p>
<p>Вздыхать и думать про себя:</p>
<p>Когда же черт возьмет тебя!</p>
</div>
</section>
</section>
<section id="gost-cryptofox">
<h2>Задача 2. Анализ GOST-CryptoFox<a class="headerlink" href="#gost-cryptofox" title="Link to this heading">#</a></h2>
<section id="phan-tich-gost-cryptofox">
<h3>Phân tích GOST-CryptoFox<a class="headerlink" href="#phan-tich-gost-cryptofox" title="Link to this heading">#</a></h3>
<p>Đặt <span class="math notranslate nohighlight">\(V_{n}(2^m)\)</span> là không gian vector <span class="math notranslate nohighlight">\(n\)</span> chiều trên trường <span class="math notranslate nohighlight">\(\mathbb{F}_{2^m}\)</span>, <span class="math notranslate nohighlight">\(\boxplus\)</span> là phép cộng trên vành <span class="math notranslate nohighlight">\(\mathbb{Z}_{2^{32}}\)</span> (phép cộng modulo <span class="math notranslate nohighlight">\(2^{32}\)</span>), <span class="math notranslate nohighlight">\(\oplus\)</span> là phép cộng trên <span class="math notranslate nohighlight">\(V_{n}(2)\)</span> (phép XOR).</p>
<p>Đặt <span class="math notranslate nohighlight">\(\psi : V_{32}(2) \to \mathbb{Z}_{2^{32}}\)</span> là hàm biến đổi vector 32 bit thành số nguyên 32 bit. Công thức của hàm <span class="math notranslate nohighlight">\(\psi\)</span> là</p>
<div class="math notranslate nohighlight">
\[\psi(\beta) = \bar{\beta} = \sum_{i=1}^{32} \beta_i 2^{32-i}\]</div>
<p>với <span class="math notranslate nohighlight">\(\beta = (\beta_1, \beta_2, \ldots, \beta_{32}) \in V_{32}(2)\)</span> và <span class="math notranslate nohighlight">\(\bar{\beta} \in \mathbb{Z}_{2^{32}}\)</span>.</p>
<p>Trường <span class="math notranslate nohighlight">\(\mathbb{F}_{2^8}\)</span> dùng đa thức tối giản <span class="math notranslate nohighlight">\(1 + x^2 + x^3 + x^4 + x^8\)</span> với nghiệm <span class="math notranslate nohighlight">\(\theta\)</span>. Phần tử trên <span class="math notranslate nohighlight">\(\mathbb{F}_{2^8}\)</span> được viết dưới dạng vector <span class="math notranslate nohighlight">\(V_8(2)\)</span>.</p>
<p>GOST-CryptoFox dùng 32 vòng, độ dài khối là 64 bit và độ dài khóa là 256 bit.</p>
<p>Ngoài ra, trong thuật toán sử dụng:</p>
<ul class="simple">
<li><p>các hoán vị <span class="math notranslate nohighlight">\(\pi_1, \pi_2, \pi_3, \pi_4\)</span> trên tập <span class="math notranslate nohighlight">\(\{ 1, 2, \ldots, 8 \}\)</span> để chỉ định khóa con cho từng vòng</p></li>
<li><p>các hoán vị 8 bit <span class="math notranslate nohighlight">\(s_1, s_2, s_3, s_4\)</span> là các S-box của thuật toán</p></li>
</ul>
<section id="thuat-toan-sinh-khoa-con">
<h4>Thuật toán sinh khóa con<a class="headerlink" href="#thuat-toan-sinh-khoa-con" title="Link to this heading">#</a></h4>
<p>Khóa đầu vào <span class="math notranslate nohighlight">\(K\)</span> có 256 bit.</p>
<ul class="simple">
<li><p>Khóa <span class="math notranslate nohighlight">\(K\)</span> đầu tiên được chia thành 8 đoạn 32 bit, <span class="math notranslate nohighlight">\(K = K_1 \Vert K_2 \Vert \ldots \Vert K_8\)</span>. Như vậy <span class="math notranslate nohighlight">\(K \in V_{256}(2)\)</span>, <span class="math notranslate nohighlight">\(K_i \in V_{32}(2)\)</span> với <span class="math notranslate nohighlight">\(1 \leqslant i \leqslant 8\)</span></p></li>
<li><p>Ở các vòng 1–8, sử dụng hoán vị <span class="math notranslate nohighlight">\(\pi_1\)</span> để chỉ định khóa con, cụ thể là ở vòng thứ <span class="math notranslate nohighlight">\(i\)</span> sẽ dùng khóa <span class="math notranslate nohighlight">\(k_i = K_{\pi_1(i)}\)</span>, <span class="math notranslate nohighlight">\(1 \leqslant i \leqslant 8\)</span></p></li>
<li><p>Ở các vòng 9–16, sử dụng hoán vị <span class="math notranslate nohighlight">\(\pi_2\)</span> để chỉ định khóa con, cụ thể là ở vòng thứ <span class="math notranslate nohighlight">\(i+8\)</span> sẽ dùng khóa con <span class="math notranslate nohighlight">\(k_{i+8} = K_{\pi_2(i)}\)</span>, <span class="math notranslate nohighlight">\(1 \leqslant i \leqslant 8\)</span></p></li>
<li><p>Ở các vòng 17–24, sử dụng hoán vị <span class="math notranslate nohighlight">\(\pi_3\)</span> để chỉ định khóa con, cụ thể là ở vòng thứ <span class="math notranslate nohighlight">\(i+16\)</span> sẽ dùng khóa con <span class="math notranslate nohighlight">\(k_{i+16} = K_{\pi_3(i)}\)</span>, <span class="math notranslate nohighlight">\(1 \leqslant i \leqslant 8\)</span></p></li>
<li><p>Ở các vòng 25–32, sử dụng hoán vị <span class="math notranslate nohighlight">\(\pi_4\)</span> để chỉ định khóa con, cụ thể là ở vòng thứ <span class="math notranslate nohighlight">\(i+24\)</span> sẽ dùng khóa con <span class="math notranslate nohighlight">\(k_{i+24} =K_{\pi_4(i)}\)</span>, <span class="math notranslate nohighlight">\(1 \leqslant i \leqslant 8\)</span></p></li>
</ul>
<p>Khi đó các khóa con cho 32 vòng là <span class="math notranslate nohighlight">\(k_1, k_2, \ldots, k_{32}\)</span>.</p>
</section>
<section id="thuat-toan-ma-hoa">
<h4>Thuật toán mã hóa<a class="headerlink" href="#thuat-toan-ma-hoa" title="Link to this heading">#</a></h4>
<p>GOST-CryptoFox 2024 dựa trên mô hình Feistel. Round function <span class="math notranslate nohighlight">\(f_k : V_{64}(2) \to V_{64}(2)\)</span> với khóa <span class="math notranslate nohighlight">\(k \in V_{32}(2)\)</span>:</p>
<div class="math notranslate nohighlight">
\[f_k : (\alpha_1, \alpha_2) \to (\alpha_2, \alpha_1 \oplus g_k (\alpha_2, k)), \quad \alpha_1, \alpha_2 \in V_{32}(2)\]</div>
<p>với <span class="math notranslate nohighlight">\(g_k : V_{32}(2) \to V_{32}(2)\)</span> xác định bởi</p>
<div class="math notranslate nohighlight">
\[g_k : \alpha \to h(S(\psi^{-1}(\psi(\alpha) \boxplus \psi(k)))),\]</div>
<p>trong đó:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(h\)</span> là ánh xạ tuyến tính trên <span class="math notranslate nohighlight">\(V_{32}(2)\)</span> xác định bởi ma trận <span class="math notranslate nohighlight">\(4 \times 4\)</span> là <span class="math notranslate nohighlight">\(\mathbf{H}\)</span> trên <span class="math notranslate nohighlight">\(\mathbb{F}_{2^8}\)</span>,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
    h(\lambda^{(1)}, \ldots, \lambda^{(4)}) = (\lambda^{(1)}, \ldots, \lambda^{(4)}) \mathbf{H}, \quad \lambda^{(1)}, \ldots, \lambda^{(4)} \in \mathbb{F}_{2^8},
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
    \mathbf{H} = \begin{pmatrix}
        \theta &amp; \theta \oplus 1 &amp; 1 &amp; 1 \\
        1 &amp; \theta &amp; \theta \oplus 1 &amp; 1 \\
        1 &amp; 1 &amp; \theta &amp; \theta \oplus 1 \\
        \theta \oplus 1 &amp; 1 &amp; 1 &amp; \theta \\
    \end{pmatrix},
\end{split}\]</div>
<ul class="simple">
<li><p>S-box <span class="math notranslate nohighlight">\(S = (s_1, s_2, s_3, s_4)\)</span> gồm 4 S-box con theo quy tắc</p></li>
</ul>
<div class="math notranslate nohighlight">
\[S(\beta) = (s_1 (\beta^{(1)}), \ldots, s_4 (\beta^{(4)})), \quad \beta = (\beta^{(1)}, \ldots, \beta^{(4)}) \in V_4(2^8),\]</div>
<p>nghĩa là khi đó:</p>
<ul class="simple">
<li><p>hai vector 32 bit <span class="math notranslate nohighlight">\(\alpha\)</span> và <span class="math notranslate nohighlight">\(k\)</span> sẽ được chuyển thành số nguyên 32 bit và cộng modulo <span class="math notranslate nohighlight">\(2^{32}\)</span>, kết quả sau đó được chuyển lại thành vector 32 bit</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\lambda = \psi^{-1}(\psi(\alpha) \boxplus \psi(k));\]</div>
<ul class="simple">
<li><p>vector 32 bit <span class="math notranslate nohighlight">\(\lambda\)</span> được chia thành 4 đoạn <span class="math notranslate nohighlight">\(\lambda^{(1)}, \ldots, \lambda^{(4)}\)</span> là các phần tử <span class="math notranslate nohighlight">\(\mathbb{F}_{2^8}\)</span> và biểu diễn <span class="math notranslate nohighlight">\(\lambda = (\lambda^{(1)}, \ldots, \lambda^{(4)})\)</span> là không gian 4 chiều <span class="math notranslate nohighlight">\(V_4(2^8)\)</span>. Sau đó tính <span class="math notranslate nohighlight">\(\beta = \lambda \mathbf{H}\)</span>;</p></li>
<li><p>vector 32 bit <span class="math notranslate nohighlight">\(\beta\)</span> được chia thành 4 vector 8 bit là <span class="math notranslate nohighlight">\(\beta^{(1)}, \ldots, \beta^{(4)}\)</span>. Sau đó mỗi vector <span class="math notranslate nohighlight">\(\beta^{(i)}\)</span> đi qua S-box con <span class="math notranslate nohighlight">\(s_i\)</span>, <span class="math notranslate nohighlight">\(i = 1, 2, 3, 4\)</span>. Bốn kết quả được ghép lại nhau thành <span class="math notranslate nohighlight">\(S(\beta)\)</span>.
\end{itemize}</p></li>
</ul>
<p>Mã hóa là hàm <span class="math notranslate nohighlight">\(b_K : V_{64}(2) \to V_{64}(2)\)</span> định nghĩa bởi phương trình:</p>
<div class="math notranslate nohighlight">
\[b_K(\alpha) = g_{k_32} g_{k_31} \ldots g_{k_2} g_{k_1} (\alpha), \quad \alpha \in V_{64}(2)\]</div>
</section>
</section>
<section id="id2">
<h3>Câu hỏi<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Trong hệ mật mã GOST-CryptoFox trên đầy đủ 32 vòng tìm các vi sai liên quan đến các khóa với xác suất là 1 và chỉ sử dụng các khóa liên quan và cặp plaintext thích hợp. Điều đó nghĩa là, với mỗi khóa chưa biết <span class="math notranslate nohighlight">\(K \in V_{256}\)</span> tìm phần tử <span class="math notranslate nohighlight">\(\varepsilon \in V_{256} \backslash \{ \vec{0}_{256} \}\)</span> và <span class="math notranslate nohighlight">\(\delta_1, \delta_2 \in V_{64}\)</span> sao cho với cách chọn ngẫu nhiên plaintext <span class="math notranslate nohighlight">\(\alpha \in V_{64}(2)\)</span> đẳng thức vi sai với xác suất là 1 là phương trình:</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq-fox24-2">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-fox24-2" title="Link to this equation">#</a></span>\[        b_K(\alpha) \oplus b_{K \oplus \varepsilon} (\alpha \oplus \delta_1) = \delta_2\]</div>
<ol class="arabic simple" start="2">
<li><p>(Câu hỏi research). Thay phép <span class="math notranslate nohighlight">\(\boxplus\)</span> bằng phép <span class="math notranslate nohighlight">\(\oplus\)</span> trong mô hình GOST-CryptoFox 2024 ở trên và ký hiệu là mô hình GOST-CryptoFox-<span class="math notranslate nohighlight">\(\oplus\)</span>. Thực hiện tấn công trên mô hình GOST-CryptoFox-<span class="math notranslate nohighlight">\(\oplus\)</span> 2024 với nhiều vòng nhất có thể và đánh giá độ phức tạp. Có khả năng tấn công GOST-CryptoFox-<span class="math notranslate nohighlight">\(\oplus\)</span> đầy đủ 32 vòng hay không?</p></li>
</ol>
<div class="dropdown admonition">
<p class="admonition-title">Lời giải bị sai của mình</p>
<p>Для каждого неизвестного ключа шифрования <span class="math notranslate nohighlight">\(K \in V_{256}\)</span> нужно найти такие <span class="math notranslate nohighlight">\(\varepsilon \in V_{256} \setminus \{ \bar{0}_{256} \}, \delta_1, \delta_2 \in V_{64}\)</span> что при случайном и равновероятном выборе открытого текста <span class="math notranslate nohighlight">\(\alpha \in V_{64}(2)\)</span> равенство с вероятностью 1 справедливо равенство</p>
<div class="math notranslate nohighlight">
\[b_K(\alpha) \oplus b_{K \oplus \varepsilon}(\alpha \oplus \delta_1) = \delta_2\]</div>
<p>Допустим ключ шифрования <span class="math notranslate nohighlight">\(K\)</span> разделяется на 8 частей <span class="math notranslate nohighlight">\(K_1, K_2, \ldots, K_8\)</span>, где <span class="math notranslate nohighlight">\(K_1, \ldots, K_8 \in V_{32}(2)\)</span>. Значит <span class="math notranslate nohighlight">\(K = K_1 \Vert K_2 \Vert \ldots \Vert K_8\)</span>.</p>
<p>Процесс шифрования задается равенством</p>
<div class="math notranslate nohighlight">
\[b_K(\alpha) = g_{k_{32}} \ldots g_{k_2} g_{k_1} (\alpha)\]</div>
<p>где <span class="math notranslate nohighlight">\(\alpha \in V_{64}(2)\)</span> – двоичный вектор длины 64.</p>
<p>Допустим <span class="math notranslate nohighlight">\(\alpha = \alpha_1 \Vert \alpha_2\)</span>, где <span class="math notranslate nohighlight">\(\alpha_1, \alpha_2 \in V_{32}\)</span>. В первом раунде, мы рассмотрим часть <span class="math notranslate nohighlight">\(\alpha_2\)</span>.</p>
<p>У нас есть</p>
<div class="math notranslate nohighlight">
\[g_{k_1}(\alpha_2) = h(S(\psi^{-1}(\psi(\alpha_2) \boxplus \psi(k_1))))\]</div>
<p>Аналогично, обозначим</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\varepsilon = \varepsilon_1 \Vert \varepsilon_2 \Vert \ldots \Vert \varepsilon_{8}\)</span>, где <span class="math notranslate nohighlight">\(\varepsilon \in V_{256}(2)\)</span> и <span class="math notranslate nohighlight">\(\varepsilon_1, \varepsilon_2, \ldots, \varepsilon_{8} \in V_{32}(2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\delta_1 = \delta_{11} \Vert \delta_{12}\)</span>, где <span class="math notranslate nohighlight">\(\delta_1 \in V_{64}(2)\)</span>, <span class="math notranslate nohighlight">\(\delta_{11}, \delta_{12} \in V_{32}\)</span></p></li>
</ul>
<p>Тогда</p>
<div class="math notranslate nohighlight">
\[g_{k_1 \oplus \varepsilon_2}(\alpha_2 \oplus \delta_{12}) = h(S(\psi^{-1}(\psi(\alpha_2 \oplus \delta_{12}) \boxplus \psi(k_1 \oplus \varepsilon_2))))\]</div>
<p>Заметим, что если <span class="math notranslate nohighlight">\(\varepsilon_2 \equiv \delta_{12}\)</span>, тогда <span class="math notranslate nohighlight">\(\psi(\alpha_2) \boxplus \psi(k_1) \equiv \psi(\alpha_2 \oplus \delta_{12}) \boxplus \psi(k_1 \oplus \varepsilon_2)\)</span>. Например, если у меня есть (на кольце <span class="math notranslate nohighlight">\(2^4 = 16\)</span>) <span class="math notranslate nohighlight">\(a = 13\)</span> и <span class="math notranslate nohighlight">\(k = 6\)</span>. Тогда <span class="math notranslate nohighlight">\(a \boxplus b = 3 \pmod{2^{4}}\)</span>. Выбираем <span class="math notranslate nohighlight">\(b = 10\)</span> и <span class="math notranslate nohighlight">\(l = 10\)</span>, тогда <span class="math notranslate nohighlight">\(a \oplus b = 13 \oplus 10 = 1101 \oplus 1010 = 0111 = 7\)</span>, и <span class="math notranslate nohighlight">\(k \oplus l = 6 \oplus 10 = 0110 \oplus 1010 = 1100 = 12\)</span>. Получаем <span class="math notranslate nohighlight">\(7 \boxplus 12 = 3 \pmod{2^{4}}\)</span>.</p>
<p>Через перый раунд,</p>
<div class="math notranslate nohighlight">
\[f_{k_1} : (a_1, a_2) \to (a_1' = a_2, a_2' = a_1 \oplus g_{k_1} (a_2))\]</div>
<p>еще одно свойство</p>
<div class="math notranslate nohighlight">
\[f_{k_1 \oplus \varepsilon_2} : (a_1 \oplus \delta_{11}, a_2 \oplus \delta_{12}) \to (A_1' = a_2 \oplus \delta_{12}, A_2' = a_1 \oplus \delta_{11} \oplus g_{k_1 \oplus \varepsilon_2}(a_2 \oplus \delta_{12}))\]</div>
<p>Как показан выше, <span class="math notranslate nohighlight">\(a_2' \oplus A_2' = \delta_{11}\)</span> и <span class="math notranslate nohighlight">\(a_1' \oplus A_1' = \delta_{12}\)</span>.</p>
<p>Через второй раунд,</p>
<div class="math notranslate nohighlight">
\[f_{k_2} : (a_1', a_2') \to (a_1'' = a_2', a_2'' = a_1' \oplus g_{k_2} (a_2'))\]</div>
<p>Это следует <span class="math notranslate nohighlight">\(a_1'' = a_2' = a_1 \oplus g_{k_1}(a_2)\)</span> и <span class="math notranslate nohighlight">\(a_2'' = a_2 \oplus g_{k_2} (a_1 \oplus g_{k_1} (a_2))\)</span>.</p>
<p>Аналогично</p>
<div class="math notranslate nohighlight">
\[f_{k_2 \oplus \varepsilon_1} : (A_1', A_2') \to (A_1'' = A_2', A_2'' = A_1' \oplus g_{k_2 \oplus \varepsilon_1} (A_2'))\]</div>
<p>Это следует <span class="math notranslate nohighlight">\(A_1'' = A_2' = a_1 \oplus \delta_{11} \oplus g_{k_1 \oplus \varepsilon_2} (a_2 \oplus \delta_{12})\)</span> и <span class="math notranslate nohighlight">\(A_2'' = A_1' \oplus g_{k_2 \oplus \varepsilon_1}(A_2') = a_2 \oplus \delta_{12} \oplus g_{k_2 \oplus \varepsilon_1} (a_1 \oplus \delta_{11} \oplus g_{k_1 \oplus \varepsilon_2} (a_2 \oplus \delta_{12})\)</span>.</p>
<p>Поэтому</p>
<div class="math notranslate nohighlight">
\[a_1'' \oplus A_1'' = \delta_{11}\]</div>
<p>так как <span class="math notranslate nohighlight">\(g_{k_1 \oplus \varepsilon_2} (a_2 \oplus \delta_{12}) \equiv g_{k_1} (a_2)\)</span> как доказано выше.</p>
<p>И пусть <span class="math notranslate nohighlight">\(G = a_1 \oplus g_{k_1 \oplus \varepsilon_2} (a_2 \oplus \delta_{12}) = a_1 \oplus g_{k_1} (a_2)\)</span>, тогда у нас есть</p>
<div class="math notranslate nohighlight">
\[a_2'' \oplus A_2'' = \delta_{12} \oplus g_{k_2} (G) \oplus g_{k_2 \oplus \varepsilon_1} (\delta_{11} \oplus G)\]</div>
<p>Аналогично, если выберем <span class="math notranslate nohighlight">\(\varepsilon_1 \equiv \delta_{11}\)</span>, мы получми <span class="math notranslate nohighlight">\(g_{k_2} (G) \equiv g_{k_2 \oplus \varepsilon_1} (\delta_{11} \oplus G)\)</span> и отсюда <span class="math notranslate nohighlight">\(a_2'' \oplus A_2'' = \delta_{12}\)</span>.</p>
<p>Можем отметить, что после два раунда, для любого открытого тектса <span class="math notranslate nohighlight">\(a \in V_{64}\)</span> и для любого подключей шифрования <span class="math notranslate nohighlight">\(k_1, k_2 \in V_{32}\)</span>, дифференциальный будет фиксирован</p>
<div class="math notranslate nohighlight">
\[a_1'' \Vert a_2'' \oplus A_1'' \Vert a_2'' = \delta_{11} \Vert \delta_{12}\]</div>
<p>Продолжаем этот процесс и получим, что</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    \varepsilon_3 &amp; = \delta_{12}, \\
    \varepsilon_4 &amp; = \delta_{11}, \\
    \varepsilon_5 &amp; = \delta_{12}, \\
    \varepsilon_6 &amp; = \delta_{11}, \\
    \varepsilon_7 &amp; = \delta_{12}, \\
    \varepsilon_8 &amp; = \delta_{11}
\end{align*}\end{split}\]</div>
<p>и дифференциал между <span class="math notranslate nohighlight">\(a^{(i)}\)</span> и <span class="math notranslate nohighlight">\(A^{(i)}\)</span> после <span class="math notranslate nohighlight">\(i\)</span>-ого раунда, где <span class="math notranslate nohighlight">\(1 \leqslant i \leqslant 32\)</span>, равен</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    a^{(i)} \oplus A^{(i)} = \begin{cases}
        \delta_{12} \Vert \delta_{11}, \text{если } i \text{ нечетный}, \\
        \delta_{11} \Vert \delta_{12}, \text{если } i \text{ четный}
    \end{cases}
\end{split}\]</div>
<p>Ответ: такие векторы, удовлетворящие равенство</p>
<div class="math notranslate nohighlight">
\[
    b_K(a) \oplus b_{K \oplus \varepsilon} (a \oplus \delta_1) = \delta_2
\]</div>
<p>с вероятностью 1 построены со следующем образом:</p>
<ol class="arabic simple">
<li><p>Быбрать любой ненулевой вектор <span class="math notranslate nohighlight">\(\delta_1 = \delta_{11} \Vert \delta_{12}\)</span>, где <span class="math notranslate nohighlight">\(\delta_1 \in V_{64}(2)\)</span> и <span class="math notranslate nohighlight">\(\delta_{11}, \delta_{12} \in V_{32}(2)\)</span></p></li>
<li><p>Построить вектор <span class="math notranslate nohighlight">\(\varepsilon = \delta_{12} \Vert \delta_{11} \Vert \delta_{12} \Vert \delta_{11} \Vert \delta_{12} \Vert \delta_{11} \Vert \delta_{12} \Vert \delta_{11}\)</span>, где <span class="math notranslate nohighlight">\(\varepsilon \in V_{256}\)</span></p></li>
<li><p>Тогда получим <span class="math notranslate nohighlight">\(\delta_2 \equiv \delta_1 = \delta_{11} \Vert \delta_{12} \in V_{64}\)</span></p></li>
</ol>
</div>
</section>
</section>
<section id="id3">
<h2>Задача 3. Инвариантные структуры<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<section id="id4">
<h3>Câu hỏi<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>Alice và Bob sử dụng thuật toán PRINTcipher-48 để mã hóa dữ liệu. Eva rất muốn biết Alice và Bob đã trao đổi thông tin gì bằng thuật toán này. Eva biết được perm key là 7e92c53f và 10 cặp plaintext-ciphertext theo bảng sau:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>№</p></th>
<th class="head"><p>Открытый текст</p></th>
<th class="head"><p>Шифртекст</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>5ef30b0e8810</p></td>
<td><p>63b05da1572d</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>08419219c0a9</p></td>
<td><p>19919629a291</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>2ba2a41913b3</p></td>
<td><p>39f39539b0af</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>27da9fea907c</p></td>
<td><p>1feeef47a39b</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>2b52a13970b2</p></td>
<td><p>1b32b8080293</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>c0cb1af1b482</p></td>
<td><p>9c9e8cb63ff9</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>6cd9e41199a3</p></td>
<td><p>A6238ffd3462</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>0b40872901a5</p></td>
<td><p>2bf09e0a70ab</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>1a8d558c018c</p></td>
<td><p>2d16ebafea7a</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>38c3840ae3a9</p></td>
<td><p>2953ab0bf3b1</p></td>
</tr>
</tbody>
</table>
</div>
<p>Hãy giúp Eva khôi phục 80 bit của khóa bí mật. Tài liệu mô tả thuật toán cũng như cách tấn công dựa trên invariant structure (cấu trúc bất biến) <a class="footnote-reference brackets" href="#leander" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
</section>
</section>
<section id="id6">
<h2>Задача 4. Корректирующий код и шифр Вернама<a class="headerlink" href="#id6" title="Link to this heading">#</a></h2>
<section id="id7">
<h3>Câu hỏi<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>Alice gửi cho Bob thông điệp được mã hóa bằng mã Vernam.</p>
<p>Ở đây, để mã hóa thông điệp, Alice chọn một mã sửa lỗi nhị phân độ dài 256 với khả năng sửa một bit. Bob giải mã và decode thông điệp. One-time-key được sinh trước đó và được truyền bí mật giữa Alice và Bob, nghĩa là Alice gửi qua kênh truyền ciphertext <span class="math notranslate nohighlight">\(y\)</span> bằng:</p>
<div class="math notranslate nohighlight">
\[y = \text{code}(x) \oplus key,\]</div>
<p>trong đó:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x \in \{0, 1\}^m\)</span> - thông điệp</p></li>
<li><p><span class="math notranslate nohighlight">\(y \in \{0, 1\}^{256}\)</span> - ciphertext</p></li>
<li><p><span class="math notranslate nohighlight">\(key \in \{0, 1\}^{256}\)</span> - khóa bí mật one-time</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> - độ dài thông điệp và là kích thước của code</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{code}: \{0, 1\}^m \to \{0, 1\}^{256}\)</span> - hàm encode của mã sửa lỗi</p></li>
<li><p><span class="math notranslate nohighlight">\(\oplus\)</span> - phép XOR.</p></li>
</ul>
<p>Bob nhận được ciphertext <span class="math notranslate nohighlight">\(y\)</span> và giải mã bằng cách</p>
<div class="math notranslate nohighlight">
\[x = \text{decode}(y \oplus key),\]</div>
<p>với <span class="math notranslate nohighlight">\(\text{decode} : \{ 0, 1 \}^{256} \to \{ 0, 1 \}^m\)</span> là hàm decode của mã sửa lỗi.</p>
<p>Anton và Bella muốn sử dụng kênh truyền của Alice và Bob để trao đổi thông tin. Anton có thể lặng lẽ đọc và thay đổi ciphertext <span class="math notranslate nohighlight">\(y\)</span> trước khi Alice chuyển qua kênh truyền. Bella thì có thể đọc ciphertext từ kênh truyền. Cả Anton và Bella đều không biết khóa bí mật one-time, mà chỉ biết về mã sửa lỗi (độ dài <span class="math notranslate nohighlight">\(m\)</span> và thuật toán). Biết rằng xác suất xảy ra lỗi trên kênh truyền là <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>Anton có thể gửi thông điệp cho Bella, sử dụng kênh truyền của Alice và Bob, mà không ảnh hưởng hay tiết lộ sự tồn tại của bản thân không? Nếu có, lượng thông tin lớn nhất mà Anton có thể gửi đi trong một thông-điệp-Alice là bao nhiêu?</p>
</section>
</section>
<section id="id8">
<h2>Задача 5. Эффективная реализация<a class="headerlink" href="#id8" title="Link to this heading">#</a></h2>
<section id="id9">
<h3>Câu hỏi<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>Alice nhận được một thiết bị phần cứng, cho phép thực hiện các phép tính trên đường cong elliptic, bao gồm: cộng, trừ, nhân đôi, nhân ba và nhân 7 (nhân vô hướng một điểm với 7).</p>
<p>Để kiểm tra độ chính xác của thiết bị, Alice kiểm tra phép nhân vô hướng một điểm cho <span class="math notranslate nohighlight">\(2024\)</span>.</p>
<p>Cô ấy tìm được một dãy gồm 9 hành động, bao gồm 1 phép cộng, 5 phép nhân đôi, 2 phép nhân ba và 1 phép nhân 7.</p>
<p>Có thể tính phép nhân <span class="math notranslate nohighlight">\(2024 G\)</span> với ít hành động hơn không? Nếu có, hãy chỉ ra cách tính. Nếu không thể, hãy chứng minh.</p>
<div class="dropdown admonition">
<p class="admonition-title">Lời giải bị sai của mình</p>
<p>Пусть <span class="math notranslate nohighlight">\(G\)</span> - начальная точка. Нам нужно вычислять точку <span class="math notranslate nohighlight">\(2024 G\)</span>.</p>
<p>Так как <span class="math notranslate nohighlight">\(2024 = 2^3 \cdot 11 \cdot 23\)</span>, значит это число не имеет вид <span class="math notranslate nohighlight">\(2^i \cdot 3^j \cdot 7^k\)</span>, мы получим, что <span class="math notranslate nohighlight">\(2024\)</span> должно разделиться на два слагаемых:</p>
<div class="math notranslate nohighlight">
\[2024 = 2^a \cdot 3^b \cdot 7^c + 2^m \cdot 3^n \cdot 7^p\]</div>
<p>После пытаться получим, что <span class="math notranslate nohighlight">\(2024 = 2^3 + 2^5 \cdot 3^2 \cdot 7\)</span>. Это значит, нужно одно действие сложения, 5 действий удвоения (<span class="math notranslate nohighlight">\(5 = \max \{ 3, 5 \}\)</span>), 2 действия утроения и 1 усемерения. Общее число действия равно 9.</p>
<p>Теперь докажу, что не можно вычислять <span class="math notranslate nohighlight">\(2024 \cdot G\)</span> с меньше количеством действий, чем 9.</p>
<p>Мы уже разделили 2024 на сумму двух слагаемых. Сейчас попробуем разделить на сумму трех слагаемых, т.е.</p>
<div class="math notranslate nohighlight">
\[2024 = 2^a \cdot 3^b \cdot 7^c + 2^m \cdot 3^n \cdot 7^p + 2^u \cdot 3^v \cdot 7^w\]</div>
<p>Так как здесь уже есть 2 действия сложения, мы хотим уменьшить степени <span class="math notranslate nohighlight">\(2^5\)</span>, или <span class="math notranslate nohighlight">\(3^2\)</span>, или 7. Заметим, что</p>
<ul class="simple">
<li><p>Удвоение эквивалент сложение, <span class="math notranslate nohighlight">\(2 = 1 + 1\)</span>, или <span class="math notranslate nohighlight">\(2G = G + G\)</span>. Это значит, что в каждом случае требуется одно действие (либо удвоение, либо сложение)</p></li>
<li><p>Утроение – <span class="math notranslate nohighlight">\(3 = 2 + 1\)</span>. Здесь, для утроения требуется одно дейстие, а <span class="math notranslate nohighlight">\(2+1\)</span> требуются два действия (удвоение и сложение). Поэтому разделение 3 на 2+1 не является актуальным</p></li>
<li><p>Усемерение – <span class="math notranslate nohighlight">\(7 = 2 \cdot 3 + 1 = 2^2 + 3\)</span>. Здесь, для усемерения требуется одно действие, для <span class="math notranslate nohighlight">\(2 \cdot 3 + 1\)</span> требуются 3 действия (одно удвоение, одно утроение, одно сложение), и для <span class="math notranslate nohighlight">\(2^2 + 3\)</span> требуются 4 действия (два удвоения, одно утроения, одно сложение)</p></li>
<li><p><span class="math notranslate nohighlight">\(3^2 = 7 + 2\)</span> – <span class="math notranslate nohighlight">\(3^2\)</span> требуются два действия утроения, а <span class="math notranslate nohighlight">\(7+2\)</span> нужно 3 действия (удвоение, усемерение и слжение)</p></li>
<li><p><span class="math notranslate nohighlight">\(7^2 = 2^4 \cdot 3 + 1 = \ldots = 2^i \cdot 3^j \cdot 7^k + 2^r \cdot 3^s \cdot 7^t\)</span> (все способов разделения <span class="math notranslate nohighlight">\(7^2\)</span> на сумму 2 слагаемых с факторами 2, 3 и 7) – для каждого способа требуются более 2 действия</p></li>
</ul>
<p>Это значит, когда разделить 2024 на сумму трёх слагаемых, количество действия либо сохраняется, либо увеличится.</p>
<p>Ответ: НЕВОЗМОЖНО.</p>
</div>
</section>
</section>
<section id="id10">
<h2>Задача 7. Диффенциальная равномерность<a class="headerlink" href="#id10" title="Link to this heading">#</a></h2>
<section id="id11">
<h3>Câu hỏi<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<p>Ánh xạ</p>
<div class="math notranslate nohighlight">
\[f : \mathrm{GF}(2^n) \to \mathrm{GF}(2^n)\]</div>
<p>được gọi là differential <span class="math notranslate nohighlight">\(\delta\)</span>-uniformity, nếu với mọi <span class="math notranslate nohighlight">\(a \in \mathrm{GF}(2^n)^*\)</span> và với mọi <span class="math notranslate nohighlight">\(b \in \mathrm{GF}(2^n)\)</span> phương trình</p>
<div class="math notranslate nohighlight">
\[f(x + a) + f(x) = b\]</div>
<p>có không quá <span class="math notranslate nohighlight">\(\delta\)</span> nghiệm trên <span class="math notranslate nohighlight">\(\mathrm{GF}(2^n)\)</span>.</p>
<p>Ví dụ, hàm nghịch đảo trên <span class="math notranslate nohighlight">\(\mathrm{GF}(2^8)\)</span> xác định bởi</p>
<div class="math notranslate nohighlight">
\[\begin{split}I(x) = \begin{cases}
    x^{-1}, \ \text{nếu} \ x \neq 0 \\
    0, \ \text{ngược lại}
\end{cases}\end{split}\]</div>
<p>là hàm differential <span class="math notranslate nohighlight">\(4\)</span>-uniformity.</p>
<p>Xét toán tử nhóm <span class="math notranslate nohighlight">\(\circ\)</span> trên <span class="math notranslate nohighlight">\(\mathrm{GF}(2^n)\)</span> với phần tử đơn vị là <span class="math notranslate nohighlight">\(e\)</span>, sao cho với mọi <span class="math notranslate nohighlight">\(x \in \mathrm{GF}(2^n)\)</span> ta có <span class="math notranslate nohighlight">\(x \circ x = e\)</span>.</p>
<p>Gọi <span class="math notranslate nohighlight">\(f\)</span> là ánh xạ</p>
<div class="math notranslate nohighlight">
\[f : \mathrm{GF}(2^n) \to \mathrm{GF}(2^n)\]</div>
<p>là ánh xạ differential <span class="math notranslate nohighlight">\(\delta\)</span>-uniformity theo toán tử nhóm <span class="math notranslate nohighlight">\(\circ\)</span>, nếu với mọi <span class="math notranslate nohighlight">\(a \in \mathrm{GF}(2^n) \backslash \{ e \}\)</span> và với mọi <span class="math notranslate nohighlight">\(b \in \mathrm{GF}(2^n)\)</span>  thì phương trình</p>
<div class="math notranslate nohighlight">
\[f(x \circ a) \circ f(x) = b\]</div>
<p>có không quá <span class="math notranslate nohighlight">\(\delta\)</span> nghiệm trên <span class="math notranslate nohighlight">\(\mathrm{GF}(2^n)\)</span>.</p>
<p>Hãy tìm toán tử <span class="math notranslate nohighlight">\(\circ\)</span> sao cho hàm <span class="math notranslate nohighlight">\(I(x)\)</span> có diffential formidity thấp nhất.</p>
</section>
</section>
<section id="id12">
<h2>Задача 8. Разделение секретов<a class="headerlink" href="#id12" title="Link to this heading">#</a></h2>
<section id="id13">
<h3>Câu hỏi<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<p>Ông chủ trước khi đi nghỉ mát đã thay đổi code 6 chữ số của két sắt và, trong mọi trường hợp, chia bí mật đó theo sơ đồ “<span class="math notranslate nohighlight">\(2\)</span> trong <span class="math notranslate nohighlight">\(N\)</span>” bằng việc vẽ một “đường thẳng” bí mật dưới vành modulo <span class="math notranslate nohighlight">\(1\)</span> triệu, trong đó code là tọa độ ban đầu của đường thẳng đó.</p>
<p>Hoàn cảnh khiến Andrey và Vladimir phải khẩn trương mở két sắt trong lúc không liên lạc được với ông chủ. Hãy giúp Andrey và Vladimir mở két với thông tin của họ: login của Andrey <span class="math notranslate nohighlight">\(x_A = 137059\)</span>, chia sẻ bí mật <span class="math notranslate nohighlight">\(y_A = 844061\)</span>, login của Vladimir là <span class="math notranslate nohighlight">\(x_B = 752024\)</span>, chia sẻ bí mật <span class="math notranslate nohighlight">\(y_B = 639516\)</span>.</p>
<div class="dropdown admonition">
<p class="admonition-title">Lời giải bị sai của mình</p>
<p>Даны:</p>
<ul class="simple">
<li><p>Логин Андрея <span class="math notranslate nohighlight">\(x_A = 137059\)</span>, доля секрета <span class="math notranslate nohighlight">\(y_A = 844061\)</span></p></li>
<li><p>Логин Владимира <span class="math notranslate nohighlight">\(x_B = 752024\)</span>, доля секрета <span class="math notranslate nohighlight">\(y_B = 639516\)</span></p></li>
</ul>
<p>Секреты созданы по схеме “2 из <span class="math notranslate nohighlight">\(N\)</span>”. Это значит существует числа <span class="math notranslate nohighlight">\(i_A, i_B\)</span>, удовлетворящие равенство</p>
<div class="math notranslate nohighlight">
\[y_A = C^{2}_{i_A} \bmod 10^6, \quad y_B = C^{2}_{i_B} \bmod 10^6\]</div>
<p>Здесь <span class="math notranslate nohighlight">\(C^a_b\)</span> - сочетание <span class="math notranslate nohighlight">\(a\)</span> элементов из множества <span class="math notranslate nohighlight">\(b\)</span> элементов.</p>
<p>Нужно отметить, что пароль является шестизначный код, это следует, что <span class="math notranslate nohighlight">\(10^5 \leqslant i_A, i_B &lt; 10^6\)</span>. С использованием компьютерной программы можем найти такие числа. Эти числа будут:</p>
<div class="math notranslate nohighlight">
\[i_A = 138967, \quad i_B = 674937\]</div>
<p>Секретная прямая проходит через две точки <span class="math notranslate nohighlight">\((x_A, i_A)\)</span> и <span class="math notranslate nohighlight">\((x_B, i_B)\)</span>. На вещественном множестве <span class="math notranslate nohighlight">\(\mathbb{R}\)</span>, уравнение прямой, которая проходит через две точки <span class="math notranslate nohighlight">\((x_1, y_1)\)</span> и <span class="math notranslate nohighlight">\((x_2, y_2)\)</span>, равно</p>
<div class="math notranslate nohighlight">
\[\frac{x - x_1}{x_2 - x_1} = \frac{y - y_1}{y_2 - y_1} \Leftrightarrow (y_2 - y_1) (x - x_1) - (x_2 - x_1) (y - y_1) = 0\]</div>
<p>Секретная прямая вычисляется над кольцом вычетов по модулю <span class="math notranslate nohighlight">\(10^6\)</span>, поэтому уравнение секретной прямой равно</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    &amp; (i_B - i_A) (x - x_A) - (x_B - x_A) (y - i_A) = 0 \bmod{10^6} \\ \Leftrightarrow \, &amp; 535970x + 385035y + 328925 = 0 \bmod{10^6}
\end{align*}\end{split}\]</div>
<p>Теперь нам нужно найти начальную ординату прямой, т.е. самый минимальный <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(10^5 \leqslant y &lt; 10^6\)</span>, который удовлетворяет это уравнение для <span class="math notranslate nohighlight">\(x = 0\)</span></p>
<div class="math notranslate nohighlight">
\[535970 \cdot 0 + 385035 y + 328925 = 0 \bmod{10^6}\]</div>
<p>Это уравнение имеет некоторые решения, это 52745, 252745, 452745, 652745 и 852745. Мы берем самый минимальный 252745.</p>
<p>Секретный код будет <span class="math notranslate nohighlight">\(C^2_{252745} \bmod{10^6} = 891140\)</span>.</p>
<p>Ответ: 891140.</p>
</div>
</section>
</section>
<section id="s">
<h2>Задача 9. Схемная сложность S-блока<a class="headerlink" href="#s" title="Link to this heading">#</a></h2>
<section id="id14">
<h3>Câu hỏi<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<p>Kí hiệu độ phức tạp mạch của hàm boolean vector (S-box) <span class="math notranslate nohighlight">\(F\)</span> trong cơ sở <span class="math notranslate nohighlight">\(B\)</span> là <span class="math notranslate nohighlight">\(L_B(F)\)</span>. Ta nói S-box khả nghịch <span class="math notranslate nohighlight">\(F : \{ 0, 1 \}^n \to \{ 0, 1 \}\)</span> là bất đối xứng (asymmetric computing), nếu với cơ sở <span class="math notranslate nohighlight">\(B\)</span> nào đó ta có <span class="math notranslate nohighlight">\(L_B(F) \neq L_B(F^{-1})\)</span>.</p>
<ol class="arabic simple">
<li><p>Chỉ ra một S-box bất đối xứng như vậy.</p></li>
<li><p>Xây dựng một họ vô hạn các S-box bất đối xứng.</p></li>
<li><p>Xây dựng một họ vô hạn các S-box bất đối xứng <span class="math notranslate nohighlight">\(\{ F_n \}\)</span> với <span class="math notranslate nohighlight">\(F_n : \{ 0, 1 \}^n \to \{ 0, 1 \}^n\)</span> và <span class="math notranslate nohighlight">\(\lim\limits_{n \to \infty} \dfrac{L_B(F_n)}{L_B(F^{-1}_n)} \neq 1\)</span>. (<em>Đây là bài toán chưa có lời giải</em>).</p></li>
</ol>
</section>
</section>
<section id="tryhard">
<h2>Задача 10. Анализ алгоритма блочного шифрования «TryHard» (исследовательская)<a class="headerlink" href="#tryhard" title="Link to this heading">#</a></h2>
<section id="id15">
<h3>Câu hỏi<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<p><img alt="Question 10" src="../../_images/question-10-2024.png" /></p>
<p>Hình trên thể hiện một vòng của thuật toán mã khối. Tất cả toán tử chạy trong bộ nhớ <span class="math notranslate nohighlight">\(16\)</span> bit. Các kí hiệu trên hình được giải nghĩa như sau:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Kí hiệu</p></th>
<th class="head"><p>Ý nghĩa</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1.1, 1.2</p></td>
<td><p>Input round key</p></td>
</tr>
<tr class="row-odd"><td><p>2.1, 2.2</p></td>
<td><p>Input word</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Phép cộng modulo <span class="math notranslate nohighlight">\(2^{16}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>4.1, 4.2</p></td>
<td><p>Toán tử XOR</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Dịch trái <span class="math notranslate nohighlight">\(5\)</span> bit</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Dịch phải <span class="math notranslate nohighlight">\(6\)</span> bit</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>Dịch trái <span class="math notranslate nohighlight">\(9\)</span> bit</p></td>
</tr>
</tbody>
</table>
</div>
<p>Thuật toán sinh khóa con cho các vòng giống với GOST 28147-89 (Magma). Trong đó nửa <span class="math notranslate nohighlight">\(16\)</span> bit đầu là round key cho 1.1 và <span class="math notranslate nohighlight">\(16\)</span> bit sau là round key cho 1.2.</p>
<p>Đầu ra của thuật toán được biểu diễn ở bảng sau.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Tên gọi</p></th>
<th class="head"><p>Ý nghĩa</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Kích thước khối đầu ra</p></td>
<td><p><span class="math notranslate nohighlight">\(32\)</span> bit</p></td>
</tr>
<tr class="row-odd"><td><p>Kích thước khóa</p></td>
<td><p><span class="math notranslate nohighlight">\(128\)</span> bit</p></td>
</tr>
<tr class="row-even"><td><p>Số lượng vòng mã hóa</p></td>
<td><p><span class="math notranslate nohighlight">\(20\)</span> vòng</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Câu hỏi.</strong> Hãy đánh giá số lượng vòng của thuật toán mã hóa, trong đó số lượng vòng cho phép đánh giá sự độc lập thống kê giữa các plaintext và ciphertext, mà qua đó khôi phục được một phần hoặc toàn bộ khóa. Hãy đề xuất thuật toán khôi phục khóa mã hóa (phải hiệu quả hơn bruteforce).</p>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="leander" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">1</a><span class="fn-bracket">]</span></span>
<p>Leander G. et al. “A cryptanalysis of PRINTcipher: the invariant subspace attack”. In: Advances in Cryptology–CRYPTO 2011: 31st Annual Cryptology Conference (Aug. 2011).</p>
</aside>
</aside>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./contests\2024"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="internet-olympiad-2024.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Internet Olympiad 2024</p>
      </div>
    </a>
    <a class="right-next"
       href="../../solutions/Judson.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Abstract Algebra: Theory and Applications</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Задача 1. дешифрование файла</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cau-hoi">Câu hỏi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loi-giai">Lời giải</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gost-cryptofox">Задача 2. Анализ GOST-CryptoFox</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phan-tich-gost-cryptofox">Phân tích GOST-CryptoFox</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thuat-toan-sinh-khoa-con">Thuật toán sinh khóa con</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thuat-toan-ma-hoa">Thuật toán mã hóa</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Câu hỏi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Задача 3. Инвариантные структуры</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Câu hỏi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Задача 4. Корректирующий код и шифр Вернама</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Câu hỏi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Задача 5. Эффективная реализация</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Câu hỏi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Задача 7. Диффенциальная равномерность</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Câu hỏi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Задача 8. Разделение секретов</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Câu hỏi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#s">Задача 9. Схемная сложность S-блока</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Câu hỏi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tryhard">Задача 10. Анализ алгоритма блочного шифрования «TryHard» (исследовательская)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Câu hỏi</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By myself
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>